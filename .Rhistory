ggplot(data, aes(vehicle.age, price)) +
geom_point() +
geom_smooth(method = loess) +
ylim(0, max(data$price))
data$vehicle.age.squared <- (vehicle.age ^ 2)
data$vehicle.age.cubed <- (vehicle.age ^ 3)
attach(data)
summary(lm(price ~ vehicle.age + vehicle.age.squared + vehicle.age.cubed))
ggplot(lm(price ~ vehicle.age + vehicle.age.squared + vehicle.age.cubed), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
ggplot(lm(price ~ vehicle.age + vehicle.age.squared), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
#model test
24530 + (-4.87)*6471 + (0.0003431)*(6471^2) + (-0.1192)*207919 + (0.0000002383)*(207919^2) + 65.09*150 + 1*1482 + 0*1034 + 0*(-572.4) + 0*1046 + 1*570.7 + 1*1996
#model test
24530 + (-4.87)*11309 + (0.0003431)*(11309^2) + (-0.1192)*172800 + (0.0000002383)*(172800^2) + 65.09*98 + 1*1482 + 0*1034 + 0*(-572.4) + 0*1046 + 1*570.7 + 0*1996
#model test
24530 + (-4.87)*2208 + (0.0003431)*(2208^2) + (-0.1192)*96000 + (0.0000002383)*(96000^2) + 65.09*310 + 1*1482 + 0*1034 + 1*(-572.4) + 0*1046 + 0*570.7 + 1*1996
corrplot(cor_matrix_2)
ggplot(data = data) +
geom_point(mapping = aes(x = vehicle.age, y = price, color = warranty)) +
geom_smooth(method = loess, mapping = aes(vehicle.age, price), color = "red")
ggplot(data = data) +
geom_point(mapping = aes(x = vehicle.age, y = price, color = manual)) +
geom_smooth(method = loess, mapping = aes(vehicle.age, price), color = "red")
data$manual <- ifelse(transmission == "Automatique" |
transmission == "Boîte manuelle automatisée" |
transmission == "Boîte automatique variable",
FALSE, TRUE)
source("~/GitHub/Data_science/scripts/models.R", echo=TRUE)
ggplot(data = data) +
geom_point(mapping = aes(x = vehicle.age, y = price, color = manual)) +
geom_smooth(method = loess, mapping = aes(vehicle.age, price), color = "red")
corrplot(cor_matrix_2)
sqrt(anova(model4)$"Mean Sq")[13]
source("~/GitHub/Data_science/scripts/models.R", echo=TRUE)
summary(model6)
#model6 test
25510 + (-4.861)*2147 + (0.0003431)*(2147^2) + (-0.1207)*83100 + (0.0000002382)*(83100^2) + 64.82*150 + 1364*1 + 851.8*1 + (-594.3)*1 + 1036*1 + 982.2*0 + (-560.8)*0 + 2056*1
sqrt(anova(model6)$"Mean Sq")[13]
summary(lm(price ~ vehicle.age))
ggplot(data, aes(vehicle.age, price)) +
geom_point() +
geom_smooth(method = lm) +
ylim(0, max(data$price))
ggplot(data, aes(vehicle.age + vehicle.age.squared, price)) +
geom_point() +
geom_smooth(method = lm) +
ylim(0, max(data$price))
ggplot(data, aes(vehicle.age.squared, price)) +
geom_point() +
geom_smooth(method = lm) +
ylim(0, max(data$price))
ggplot(data, aes(vehicle.age, price)) +
geom_point() +
geom_smooth(method = lm) +
ylim(0, max(data$price))
anova(model6)
corrplot(cor_matrix_2)
summary(model6)
cor_matrix_2
max(cor_matrix_2)
diag(cor_matrix_2)
model6_data <- select(data_no_def, c("price", "vehicle.age", "vehicle.age.squared", "kilometers", "kilometers.squared", "power", "expertise", "warranty", "wagon", "diesel", "hybrid", "manual", "awd"))
cor_matrix_3 <- cor(model6_data, use = "complete.obs")
cor_matrix_3
corrplot(cor_matrix_3)
vif(model6)
library(car)
vif(model6)
corrplot(cor_matrix_3)
cor_matrix_3
model7 <- lm(data_no_def$price ~ data_no_def$kilometers + data_no_def$kilometers.squared + data_no_def$power + data_no_def$expertise + data_no_def$warranty + data_no_def$wagon + data_no_def$diesel + data_no_def$hybrid + data_no_def$manual + data_no_def$awd)
vif(model7)
summary(model7)
model8 <- lm(data_no_def$price ~ data_no_def$vehicle.age + data_no_def$vehicle.age.squared + data_no_def$power + data_no_def$expertise + data_no_def$warranty + data_no_def$wagon + data_no_def$diesel + data_no_def$hybrid + data_no_def$manual + data_no_def$awd)
vif(model8)
summary(model8)
ggplot(data = data) +
geom_point(mapping = aes(x = vehicle.age, y = price, size = power, color = consumption), alpha = 0.5)
ggplot(data = data) +
geom_point(mapping = aes(x = vehicle.age, y = price, color = warranty)) +
scale_color_manual(values = c("red", "darkgreen", "darkgrey")) +
theme_minimal() +
theme(panel.background = element_rect(fill = "gainsboro"))+
geom_smooth(method = loess, mapping = aes(vehicle.age, price), color = "black")
ggplot(data = data) +
geom_point(mapping = aes(x = vehicle.age, y = price, size = power, color = consumption), alpha = 0.5)
ggplot(data = data) +
geom_point(mapping = aes(x = vehicle.age, y = price, color = warranty)) +
scale_color_manual(values = c("red", "darkgreen", "darkgrey")) +
theme_minimal() +
theme(panel.background = element_rect(fill = "gainsboro"))+
geom_smooth(method = loess, mapping = aes(vehicle.age, price), color = "black")
ggplot(data = data) +
geom_point(mapping = aes(x = vehicle.age, y = price, color = diesel)) +
scale_color_manual(values = c("red", "darkgreen", "darkgrey")) +
theme_minimal() +
theme(panel.background = element_rect(fill = "gainsboro"))+
geom_smooth(method = loess, mapping = aes(vehicle.age, price), color = "black")
corrplot(cor_matrix_3)
ggplot(model4, aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
model4 <- lm(price ~ vehicle.age + vehicle.age.squared + kilometers + kilometers.squared + power + expertise + warranty + wagon + diesel + hybrid + manual + awd)
summary(model4)
attributes(model6)
model6$residuals
model6$fitted.values
attributes(model6)
data$residuals <- model6$residuals
data_no_def$residuals <- model6$residuals
model6 <- lm(data_no_def$price ~ data_no_def$vehicle.age + data_no_def$vehicle.age.squared + data_no_def$kilometers + data_no_def$kilometers.squared + data_no_def$power + data_no_def$expertise + data_no_def$warranty + data_no_def$wagon + data_no_def$diesel + data_no_def$hybrid + data_no_def$manual + data_no_def$awd)
summary(model6)
na.omit(data_no_def)
na.omit(select(data_no_def, c("price", "vehicle.age", "vehicle.age.squared", "kilometers", "kilometers.squared", "power", "expertise", "warranty", "wagon", "diesel", "hybrid", "manual", "awd")))
summary(model6)
test <- na.omit(select(data_no_def, c("price", "vehicle.age", "vehicle.age.squared", "kilometers", "kilometers.squared", "power", "expertise", "warranty", "wagon", "diesel", "hybrid", "manual", "awd")))
View(test)
test <- data_no_def[na.omit(select(data_no_def, c("price", "vehicle.age", "vehicle.age.squared", "kilometers", "kilometers.squared", "power", "expertise", "warranty", "wagon", "diesel", "hybrid", "manual", "awd"))),]
test <- data_no_def[complete.cases(data_no_def[,c("price", "vehicle.age", "vehicle.age.squared", "kilometers", "kilometers.squared", "power", "expertise", "warranty", "wagon", "diesel", "hybrid", "manual", "awd")]),]
View(test)
nrow(data_no_def)
nrow(test)
data_no_def$residuals <- model6$residuals
data_no_def <- data_no_def[complete.cases(data_no_def[,c("price", "vehicle.age", "vehicle.age.squared", "kilometers", "kilometers.squared", "power", "expertise", "warranty", "wagon", "diesel", "hybrid", "manual", "awd")]),]
data_no_def$residuals <- model6$residuals
ggplot(model6, aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
data_no_def[1,2615]
data_no_def[2615,1]
data_no_def[1023,1]
data_no_def[2470,1]
data_no_def[1418,1]
data_no_def[3261,1]
attributes(model6)
data_no_def <- data_no_def |>
mutate(count = row_number()) |>
select(count, everything())
data_no_def[2299,1]
data_no_def[2299,2]
data_no_def[data_no_def$count == 2299, 2]
data_no_def[data_no_def$count == 1066, 2]
data_no_def[data_no_def$count == 1054, 2]
data_no_def[data_no_def$count == 1011, 2]
data_no_def[data_no_def$count == 2591, 2]
data_no_def[data_no_def$count == 2447, 2]
data_no_def[data_no_def$count == 2052, 2]
data_no_def[data_no_def$count == 3233, 2]
library(tidyverse)
library(corrplot)
library(Hmisc)
library(car)
setwd("~/GitHub/Data_science/cleaned-data")
data <- read.csv("audi2_cleaned.csv")
audi2_cleaned <- read.csv("audi2_cleaned.csv")
data_numeric <- select(data, c("price", "vehicle.age", "kilometers", "power", "consumption"))
data_numeric
cor_matrix <- cor(data_numeric, use = "complete.obs")
cor_matrix
corrplot(cor_matrix)
summary(lm(price ~ consumption))
ggplot(data, aes(consumption, price)) +
geom_point() +
geom_smooth(method = lm) +
ylim(0, max(data$price))
summary(lm(price ~ vehicle.age))
ggplot(data, aes(vehicle.age, price)) +
geom_point() +
geom_smooth(method = lm) +
ylim(0, max(data$price))
ggplot(lm(price ~ vehicle.age), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
ggplot(data, aes(vehicle.age, price)) +
geom_point() +
geom_smooth(method = loess) +
ylim(0, max(data$price))
data$vehicle.age.squared <- (vehicle.age ^ 2)
data$vehicle.age.cubed <- (vehicle.age ^ 3)
attach(data)
summary(lm(price ~ vehicle.age + vehicle.age.squared + vehicle.age.cubed))
data$vehicle.age.squared <- (vehicle.age ^ 2)
data$vehicle.age.cubed <- (vehicle.age ^ 3)
attach(data)
summary(lm(price ~ vehicle.age + vehicle.age.squared + vehicle.age.cubed))
ggplot(lm(price ~ vehicle.age + vehicle.age.squared + vehicle.age.cubed), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
ggplot(lm(price ~ vehicle.age + vehicle.age.squared), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
ggplot(lm(price ~ vehicle.age + vehicle.age.squared + vehicle.age.cubed), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
ggplot(lm(price ~ vehicle.age + vehicle.age.squared), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
ggplot(lm(price ~ vehicle.age + vehicle.age.squared + vehicle.age.cubed), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
ggplot(lm(price ~ vehicle.age + vehicle.age.squared), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
ggplot(lm(price ~ vehicle.age + vehicle.age.squared + vehicle.age.cubed), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
ggplot(lm(price ~ vehicle.age + vehicle.age.squared), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
ggplot(lm(price ~ vehicle.age + vehicle.age.squared + vehicle.age.cubed), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
ggplot(lm(price ~ vehicle.age + vehicle.age.squared + vehicle.age.cubed), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
ggplot(lm(price ~ vehicle.age + vehicle.age.squared), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
ggplot(lm(price ~ vehicle.age), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
ggplot(lm(price ~ vehicle.age + vehicle.age.squared), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
ggplot(lm(price ~ vehicle.age), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
ggplot(data, aes(vehicle.age, price)) +
geom_point() +
geom_smooth(method = loess) +
ylim(0, max(data$price))
ggplot(lm(price ~ vehicle.age + vehicle.age.squared), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
data$log_price <- log(data$price)
ggplot(lm(log_price ~ vehicle.age + vehicle.age.squared), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
ggplot(lm(data$log_price ~ vehicle.age + vehicle.age.squared), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
summary(lm(price ~ kilometers))
ggplot(data, aes(kilometers, price)) +
geom_point() +
geom_smooth(method = lm) +
ylim(0, max(data$price))
ggplot(lm(price ~ kilometers), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
ggplot(data, aes(kilometers, price)) +
geom_point() +
geom_smooth(method = loess) +
ylim(0, max(data$price))
ggplot(lm(price ~ kilometers), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
data$kilometers.squared <- (kilometers ^ 2)
attach(data)
summary(lm(price ~ kilometers + kilometers.squared))
ggplot(lm(price ~ kilometers + kilometers.squared), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
summary(lm(price ~ power))
ggplot(data, aes(power, price)) +
geom_point() +
geom_smooth(method = lm) +
ylim(0, max(data$price))
ggplot(lm(price ~ power), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
ggplot(lm(price ~ kilometers), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
data$kilometers.squared <- (kilometers ^ 2)
attach(data)
summary(lm(price ~ kilometers + kilometers.squared))
ggplot(lm(price ~ kilometers + kilometers.squared), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
summary(lm(price ~ power))
ggplot(data, aes(power, price)) +
geom_point() +
geom_smooth(method = lm) +
ylim(0, max(data$price))
model1 <- lm(price ~ vehicle.age + vehicle.age.squared + kilometers + kilometers.squared + power)
summary(model1)
ggplot(model1, aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
table(data$defective)[2]/table(data$defective)[1]
data_no_def <- filter(data, !defective)
model2 <- lm(data_no_def$price ~ data_no_def$vehicle.age + data_no_def$vehicle.age.squared + data_no_def$kilometers + data_no_def$kilometers.squared + data_no_def$power)
summary(model2)
ggplot(model2, aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
summary(model1)
sqrt(anova(model1)$"Mean Sq")[6] # Sd model1
sqrt(anova(model2)$"Mean Sq")[6] # Sd model2
table(body.type)
data$wagon <- body.type == "Break"
data$cabriolet <- body.type == "Cabriolet"
data$small.car <- body.type == "Petite voiture"
data$coupe <- body.type == "Coupé"
table(fuel.type)
data$hybrid <- ifelse(fuel.type == "Hybride léger essence/électrique" |
fuel.type == "Hybride rechargeable essence/électrique" |
fuel.type == "Hybride léger diesel/électrique",
TRUE, FALSE)
data$natural.gas <- fuel.type == "Gaz naturel (CNG) / Essence"
data$electric <- fuel.type == "Électrique"
table(transmission)
data$manual <- ifelse(transmission == "Automatique" |
transmission == "Boîte manuelle automatisée" |
transmission == "Boîte automatique variable",
FALSE, TRUE)
table(drivetrain)
data$awd <- drivetrain == "4 roues motrices"
attach(data)
summary(lm(price ~ expertise)) # Significant
summary(lm(price ~ warranty)) # Significant
summary(lm(price ~ wagon)) # Significant
summary(lm(price ~ cabriolet)) # Significant
summary(lm(price ~ small.car)) # NOT Significant
summary(lm(price ~ coupe)) # NOT Significant
summary(lm(price ~ diesel)) # Significant
summary(lm(price ~ diesel)) # Significant
data$diesel <- fuel.type == "Diesel"
summary(lm(price ~ diesel)) # Significant
attach(data)
summary(lm(price ~ diesel)) # Significant
summary(lm(price ~ hybrid)) # Significant
summary(lm(price ~ natural.gas)) # NOT Significant
summary(lm(price ~ electric)) # NOT Significant
table(fuel.type)
summary(lm(price ~ electric)) # NOT Significant
summary(lm(price ~ manual)) # Significant
summary(lm(price ~ awd)) # Significant
model3 <- lm(price ~ expertise + warranty + wagon + cabriolet + diesel + hybrid + manual + awd)
model3 <- lm(price ~ expertise + warranty + diesel + hybrid + manual + awd)
summary(model3)
model4 <- lm(price ~ vehicle.age + vehicle.age.squared + kilometers + kilometers.squared + power + expertise + warranty + diesel + hybrid + manual + awd)
summary(model4)
model4 <- lm(price ~ vehicle.age + vehicle.age.squared + kilometers + kilometers.squared + power + expertise + warranty + hybrid + manual + awd)
summary(model4)
model4 <- lm(price ~ vehicle.age + vehicle.age.squared + kilometers + kilometers.squared + power + expertise + warranty + manual + awd)
summary(model4)
model4 <- lm(price ~ vehicle.age + vehicle.age.squared + kilometers + kilometers.squared + power + expertise + warranty + diesel + manual + awd)
summary(model4)
summary(model3)
anova(model3)
install.packages("MASS")
library(MASS)
step.model <- stepAIC(model4, direction = "both")
summary(step.model)
stepAIC(model4, direction = "both")
summary(model3)
model4 <- lm(price ~ vehicle.age + vehicle.age.squared + kilometers + kilometers.squared + power + expertise + warranty + diesel + hybrid + manual + awd)
summary(model4)
summary(model4)
ggplot(model4, aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
sqrt(anova(model4)$"Mean Sq")[13]
sqrt(anova(model4)$"Mean Sq")[11]
sqrt(anova(model4)$"Mean Sq")[12]
model4_data <- select(data, c("price", "vehicle.age", "vehicle.age.squared", "kilometers", "kilometers.squared", "power", "expertise", "warranty", "diesel", "hybrid", "manual", "awd"))
cor_matrix_2 <- cor(model4_data, use = "complete.obs")
cor_matrix_2
corrplot(cor_matrix_2)
ggplot(lm(price ~ vehicle.age), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
ggplot(data, aes(vehicle.age, price)) +
geom_point() +
geom_smooth(method = lm) +
ylim(0, max(data$price))
ggplot(model4, aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
data_no_expensive <- filter(data, price < 40000)
ggplot(model4, aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
model10 <- lm(data_no_expensive$price ~ data_no_expensive$vehicle.age + data_no_expensive$vehicle.age.squared + data_no_expensive$kilometers + data_no_expensive$kilometers.squared + data_no_expensive$power + data_no_expensive$expertise + data_no_expensive$warranty + data_no_expensive$diesel + data_no_expensive$hybrid + data_no_expensive$manual + data_no_expensive$awd)
ggplot(model10, aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
nrow(data_no_expensive)
nrow(data_no_expensive)/nrow(data)
summary(model5)
attributes(model5)
sqrt(anova(model4)$"Mean Sq")[12]
model5$df.residual
sqrt(anova(model5)$"Mean Sq")[12]
ggplot(model4, aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
ggplot(model5, aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
model5 <- lm(data_no_expensive$price ~ data_no_expensive$vehicle.age + data_no_expensive$vehicle.age.squared + data_no_expensive$kilometers + data_no_expensive$kilometers.squared + data_no_expensive$power + data_no_expensive$expertise + data_no_expensive$warranty + data_no_expensive$diesel + data_no_expensive$hybrid + data_no_expensive$manual + data_no_expensive$awd)
data_no_expensive <- filter(data, price < 40000)
nrow(data_no_expensive)/nrow(data)
model5 <- lm(data_no_expensive$price ~ data_no_expensive$vehicle.age + data_no_expensive$vehicle.age.squared + data_no_expensive$kilometers + data_no_expensive$kilometers.squared + data_no_expensive$power + data_no_expensive$expertise + data_no_expensive$warranty + data_no_expensive$diesel + data_no_expensive$hybrid + data_no_expensive$manual + data_no_expensive$awd)
summary(model5)
ggplot(model4, aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
model5 <- lm(data_no_expensive$price ~ data_no_expensive$vehicle.age + data_no_expensive$vehicle.age.squared + data_no_expensive$kilometers + data_no_expensive$kilometers.squared + data_no_expensive$power + data_no_expensive$expertise + data_no_expensive$warranty + data_no_expensive$diesel + data_no_expensive$hybrid + data_no_expensive$manual + data_no_expensive$awd)
summary(model5)
model5 <- lm(data_no_expensive$price ~ data_no_expensive$vehicle.age + data_no_expensive$vehicle.age.squared + data_no_expensive$kilometers + data_no_expensive$kilometers.squared + data_no_expensive$power + data_no_expensive$warranty + data_no_expensive$diesel + data_no_expensive$hybrid + data_no_expensive$manual + data_no_expensive$awd)
summary(model5)
model5 <- lm(data_no_expensive$price ~ data_no_expensive$vehicle.age + data_no_expensive$vehicle.age.squared + data_no_expensive$kilometers + data_no_expensive$kilometers.squared + data_no_expensive$power + data_no_expensive$warranty + data_no_expensive$diesel + data_no_expensive$manual + data_no_expensive$awd)
summary(model5)
sqrt(anova(model5)$"Mean Sq")[12]
sqrt(anova(model5)$"Mean Sq")[10]
sqrt(anova(model5)$"Mean Sq")[11]
sqrt(anova(model5)$"Mean Sq")[10]
anova(model5)
sqrt(anova(model4)$"Mean Sq")[12]
sqrt(anova(model5)$"Mean Sq")[10]
ggplot(model5, aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
ggplot(data_no_expensive, aes(vehicle.age, price)) +
geom_point() +
geom_smooth(method = lm) +
ylim(0, max(data$price))
ggplot(model5, aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
data_no_def <- filter(data, !defective)
model6 <- lm(data_no_def$price ~ data_no_def$vehicle.age + data_no_def$vehicle.age.squared + data_no_def$kilometers + data_no_def$kilometers.squared + data_no_def$power + data_no_def$expertise + data_no_def$warranty + data_no_def$diesel + data_no_def$hybrid + data_no_def$manual + data_no_def$awd)
summary(model6)
summary(model4)
model4 <- lm(price ~ vehicle.age + vehicle.age.squared + kilometers + kilometers.squared + power + expertise + warranty + diesel + manual + awd)
summary(model4)
model4 <- lm(price ~ vehicle.age + vehicle.age.squared + kilometers + kilometers.squared + power + expertise + warranty + diesel + hybrid + manual + awd)
summary(model4)
summary(model3)
model4 <- lm(price ~ vehicle.age + vehicle.age.squared + kilometers + kilometers.squared + power + expertise + warranty + diesel + manual + awd)
summary(model4)
ggplot(model4, aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
sqrt(anova(model4)$"Mean Sq")[12]
sqrt(anova(model4)$"Mean Sq")[11]
anova(model4)
model4_data <- select(data, c("price", "vehicle.age", "vehicle.age.squared", "kilometers", "kilometers.squared", "power", "expertise", "warranty", "diesel", "manual", "awd"))
cor_matrix_2 <- cor(model4_data, use = "complete.obs")
cor_matrix_2
corrplot(cor_matrix_2)
model4_data <- select(data, c("price", "vehicle.age", "vehicle.age.squared", "kilometers", "kilometers.squared", "power", "expertise", "warranty", "diesel", "manual", "awd"))
model4_data <- select(data, c("price", "vehicle.age", "vehicle.age.squared"))
select(data, "price")
attach(data)
model4_data <- select(data, c("price", "vehicle.age", "vehicle.age.squared", "kilometers", "kilometers.squared", "power", "expertise", "warranty", "diesel", "manual", "awd"))
select(data, "price")
library(tidyverse)
library(corrplot)
library(Hmisc)
library(car)
select(data, "price")
select(data, price)
test <- select(data, price)
test <- select(data, "price")
