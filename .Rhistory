data$accident[data$accident == "Non"] <- FALSE
data$accident[data$accident == "Oui"] <- TRUE
data$accident <- as.logical(data$accident)
data$warranty[data$warranty == "Non"] <- FALSE
data$warranty[data$warranty == "Oui"] <- TRUE
data$warranty <- as.logical(data$warranty)
data$new.price <- na_if(data$new.price, "Oui")
data$new.price <- na_if(data$new.price, "Non")
data$new.price <- parse_number(data$new.price, locale = locale(grouping_mark = "'"))
unique(data$new.price[order(data$new.price)])
data$new.price[data$new.price < 5000] <- NA
data <- data[-c(1:4)]
unique(data$date[order(data$date)])
data$date[2802] <- NA
data$date <- data$date |>
format(format = "%m.%Y") |>
parse_date(format = "%m.%Y")
data$created.date <- parse_date(data$created.date)
data$expertise.date <- data$expertise.date |>
format(format = "%d.%m.%Y") |>
parse_date(format = "%d.%m.%Y")
defective_keywords_de <- c("defekt", "defect", "defeckt", "startet nicht", "starttet nicht", "gebrochen", "lampe leuchtet", "für export", "fur export", "gerausche", "geräusche", "gerräusche", "angebrochen", "angeschlagen", "beschädigt", "fehlerhaft", "lädiert", "nicht in Ordnung", "nicht mehr funktionierend", "nicht mehr gut", "schadhaft", "zerbrochen", "zerrissen", "kaputt" )
defective_keywords_2_de <- c("schäden", "problem", "schade", "probleme", "schaden")
ok_keywords_de <- c(paste("ohne", defective_keywords_2_de, sep = " "), paste("kein", defective_keywords_2_de, sep = " "), paste("keine", defective_keywords_2_de, sep = " "))
defective_keywords_fr <- c("témoin", "bruit", "défaut", "ne démarre pas", "cassé", "pour export", "pour l'export", "endommagé", "endommager", "endommage", "défectueux", "defectueux", "pas en bon état", "ne fonctionne plus", "cassé")
defective_keywords_2_fr <- c("dégâts", "dégats", "degâts", "degats", "problème", "probleme", "dommages")
ok_keywords_fr <- c(paste("sans", defective_keywords_2_fr, sep = " "), paste("pas de", defective_keywords_2_fr, sep = " "), paste("aucun", defective_keywords_2_fr, sep = " "))
defective_keywords_it <- c("spia", "rumore", "difetto", "non parte", "non si avvia", "rotto", "per l'esportazione", "per export", "danneggiato", "danneggiare", "danneggia", "difettoso", "non in buone condizioni", "non funziona più")
defective_keywords_2_it <- c("danni", "problemi", "problema")
ok_keywords_it <- c(paste("nessun", defective_keywords_2_it, sep = " "), paste("senza", defective_keywords_2_it, sep = " "))
defective_keywords_en <- c("defective", "does not start", "won't start", "broken", "light on", "for export", "noise", "faulty", "not working", "no longer working")
defective_keywords_2_en <- c("damage", "damaged", "problem", "problems")
ok_keywords_en <- c(paste("no", defective_keywords_2_en, sep = " "), paste("without", defective_keywords_2_en, sep = " "), paste("not", defective_keywords_2_en, sep = " "))
defective_keywords <- c(defective_keywords_de, defective_keywords_fr, defective_keywords_it, defective_keywords_en)
defective_keywords_2 <- c(defective_keywords_2_de, defective_keywords_2_fr, defective_keywords_2_it, defective_keywords_2_en)
ok_keywords <- c(ok_keywords_de, ok_keywords_fr, ok_keywords_it, ok_keywords_en)
data$defective <- logical(nrow(data))
for (keyword in defective_keywords_2) {
data$defective <- data$defective | grepl(keyword, data$description.text, ignore.case = TRUE)
}
for (keyword in defective_keywords_2) {
data$defective <- data$defective | grepl(keyword, data$subtitle, ignore.case = TRUE)
}
for (keyword in ok_keywords) {
data$defective <- data$defective & !grepl(keyword, data$description.text, ignore.case = TRUE)
}
for (keyword in ok_keywords) {
data$defective <- data$defective & !grepl(keyword, data$subtitle, ignore.case = TRUE)
}
for (keyword in defective_keywords) {
data$defective <- data$defective | grepl(keyword, data$description.text, ignore.case = TRUE)
}
for (keyword in defective_keywords) {
data$defective <- data$defective | grepl(keyword, data$subtitle, ignore.case = TRUE)
}
data$defective[data$accident] <- TRUE
data$fuel.type <- na_if(data$fuel.type, "-")
data$transmission <- na_if(data$transmission, "-")
data$drivetrain <- na_if(data$drivetrain, "-")
desc(data$created.date)
data$created.date
desc(data$created.date)
as.Date(desc(data$created.date))
arrange(data$created.date)
scraping_date <-
data$vehicle.age <-
order(data$created.date)
scraping_date <-
data$vehicle.age <-
print(order(data$created.date))
scraping_date <-
data$vehicle.age <-
print(order(data$created.date, decreasing = TRUE))
data$created.date[37]
scraping_date <- data$created.date[order(data$created.date, decreasing = TRUE)]
scraping_date
data$vehicle.age <-
print(order(data$created.date, decreasing = TRUE))
data$vehicle.age <-
print(order(data$created.date, decreasing = TRUE)[1])
scraping_date <- data$created.date[order(data$created.date, decreasing = TRUE)[1]]
scraping_date
golf_age <- scraping_date - data$date
golf_age
data$vehicle.age <- scraping_date - data$date
data$vehicle.age <- parse_number(scraping_date - data$date)
type(data$vehicle.age)
typeof(data$vehicle.age)
class(data$vehicle.age)
plot(price, vehicle.age)
plot(data$price, data$vehicle.age)
plot(data$vehicle.age, data$price)
data$listing.age <- scraping_date - data$created.date
data <- read.csv("golf2.csv")
golf2 <- read.csv("golf2.csv")
data$price <- parse_number(data$price, locale = locale(grouping_mark = "'"))
data$kilometers <- parse_number(data$kilometers, locale = locale(grouping_mark = "'"))
data$listing.id <- parse_number(data$listing.id)
data$consumption <- na_if(data$consumption, "-")
data$consumption <- parse_number(data$consumption)
unique(data$consumption[order(data$consumption)])
data$consumption[data$consumption > 12] <- NA
data$power <- na_if(data$power, "-")
data$power <- parse_number(data$power)
data$expertise[data$expertise == "Non"] <- FALSE
data$expertise[data$expertise == "Oui"] <- TRUE
data$expertise <- as.logical(data$expertise)
data$accident[data$accident == "Non"] <- FALSE
data$accident[data$accident == "Oui"] <- TRUE
data$accident <- as.logical(data$accident)
data$warranty[data$warranty == "Non"] <- FALSE
data$warranty[data$warranty == "Oui"] <- TRUE
data$warranty <- as.logical(data$warranty)
data$new.price <- na_if(data$new.price, "Oui")
data$new.price <- na_if(data$new.price, "Non")
data$new.price <- parse_number(data$new.price, locale = locale(grouping_mark = "'"))
unique(data$new.price[order(data$new.price)])
data$new.price[data$new.price < 5000] <- NA
data <- data[-c(1:4)]
unique(data$date[order(data$date)])
data$date[2802] <- NA
data$date <- data$date |>
format(format = "%m.%Y") |>
parse_date(format = "%m.%Y")
data$created.date <- parse_date(data$created.date)
data$expertise.date <- data$expertise.date |>
format(format = "%d.%m.%Y") |>
parse_date(format = "%d.%m.%Y")
defective_keywords_de <- c("defekt", "defect", "defeckt", "startet nicht", "starttet nicht", "gebrochen", "lampe leuchtet", "für export", "fur export", "gerausche", "geräusche", "gerräusche", "angebrochen", "angeschlagen", "beschädigt", "fehlerhaft", "lädiert", "nicht in Ordnung", "nicht mehr funktionierend", "nicht mehr gut", "schadhaft", "zerbrochen", "zerrissen", "kaputt" )
defective_keywords_2_de <- c("schäden", "problem", "schade", "probleme", "schaden")
ok_keywords_de <- c(paste("ohne", defective_keywords_2_de, sep = " "), paste("kein", defective_keywords_2_de, sep = " "), paste("keine", defective_keywords_2_de, sep = " "))
defective_keywords_fr <- c("témoin", "bruit", "défaut", "ne démarre pas", "cassé", "pour export", "pour l'export", "endommagé", "endommager", "endommage", "défectueux", "defectueux", "pas en bon état", "ne fonctionne plus", "cassé")
defective_keywords_2_fr <- c("dégâts", "dégats", "degâts", "degats", "problème", "probleme", "dommages")
ok_keywords_fr <- c(paste("sans", defective_keywords_2_fr, sep = " "), paste("pas de", defective_keywords_2_fr, sep = " "), paste("aucun", defective_keywords_2_fr, sep = " "))
defective_keywords_it <- c("spia", "rumore", "difetto", "non parte", "non si avvia", "rotto", "per l'esportazione", "per export", "danneggiato", "danneggiare", "danneggia", "difettoso", "non in buone condizioni", "non funziona più")
defective_keywords_2_it <- c("danni", "problemi", "problema")
ok_keywords_it <- c(paste("nessun", defective_keywords_2_it, sep = " "), paste("senza", defective_keywords_2_it, sep = " "))
defective_keywords_en <- c("defective", "does not start", "won't start", "broken", "light on", "for export", "noise", "faulty", "not working", "no longer working")
defective_keywords_2_en <- c("damage", "damaged", "problem", "problems")
ok_keywords_en <- c(paste("no", defective_keywords_2_en, sep = " "), paste("without", defective_keywords_2_en, sep = " "), paste("not", defective_keywords_2_en, sep = " "))
defective_keywords <- c(defective_keywords_de, defective_keywords_fr, defective_keywords_it, defective_keywords_en)
defective_keywords_2 <- c(defective_keywords_2_de, defective_keywords_2_fr, defective_keywords_2_it, defective_keywords_2_en)
ok_keywords <- c(ok_keywords_de, ok_keywords_fr, ok_keywords_it, ok_keywords_en)
data$defective <- logical(nrow(data))
for (keyword in defective_keywords_2) {
data$defective <- data$defective | grepl(keyword, data$description.text, ignore.case = TRUE)
}
for (keyword in defective_keywords_2) {
data$defective <- data$defective | grepl(keyword, data$subtitle, ignore.case = TRUE)
}
for (keyword in ok_keywords) {
data$defective <- data$defective & !grepl(keyword, data$description.text, ignore.case = TRUE)
}
for (keyword in ok_keywords) {
data$defective <- data$defective & !grepl(keyword, data$subtitle, ignore.case = TRUE)
}
for (keyword in defective_keywords) {
data$defective <- data$defective | grepl(keyword, data$description.text, ignore.case = TRUE)
}
for (keyword in defective_keywords) {
data$defective <- data$defective | grepl(keyword, data$subtitle, ignore.case = TRUE)
}
data$defective[data$accident] <- TRUE
data$fuel.type <- na_if(data$fuel.type, "-")
data$transmission <- na_if(data$transmission, "-")
data$drivetrain <- na_if(data$drivetrain, "-")
scraping_date <- data$created.date[order(data$created.date, decreasing = TRUE)[1]]
data$vehicle.age <- scraping_date - data$date
data$listing.age <- scraping_date - data$created.date
write.csv(data, file = "~/GitHub/Data_science/cleaned-data/golf2_cleaned.csv", row.names = FALSE)
test <- read.csv("~/GitHub/Data_science/cleaned-data/golf2_cleaned.csv")
library(tidyverse)
library(lubridate)
setwd("~/GitHub/Data_science/data")
data <- read.csv("audi2.csv")
audi2 <- read.csv("audi2.csv")
data$price <- parse_number(data$price, locale = locale(grouping_mark = "'"))
data$kilometers <- parse_number(data$kilometers, locale = locale(grouping_mark = "'"))
data$listing.id <- parse_number(data$listing.id)
data$consumption <- na_if(data$consumption, "-")
data$consumption <- parse_number(data$consumption)
unique(data$consumption[order(data$consumption)])
data$consumption[data$consumption > 12] <- NA
data$power <- na_if(data$power, "-")
data$power <- parse_number(data$power)
data$expertise[data$expertise == "Non"] <- FALSE
data$expertise[data$expertise == "Oui"] <- TRUE
data$expertise <- as.logical(data$expertise)
data$accident[data$accident == "Non"] <- FALSE
data$accident[data$accident == "Oui"] <- TRUE
data$accident <- as.logical(data$accident)
data$warranty[data$warranty == "Non"] <- FALSE
data$warranty[data$warranty == "Oui"] <- TRUE
data$warranty <- as.logical(data$warranty)
data$new.price <- na_if(data$new.price, "Oui")
data$new.price <- na_if(data$new.price, "Non")
data$new.price <- parse_number(data$new.price, locale = locale(grouping_mark = "'"))
unique(data$new.price[order(data$new.price)])
data$new.price[data$new.price < 5000] <- NA
data <- data %>% select(-web.scraper.order, -web.scraper.start.url, -page, -annonce.link)
unique(data$date[order(data$date)])
data$date <- data$date |>
format(format = "%m.%Y") |>
parse_date(format = "%m.%Y")
data$created.date <- parse_date(data$created.date)
data$expertise.date <- data$expertise.date |>
format(format = "%d.%m.%Y") |>
parse_date(format = "%d.%m.%Y")
defective_keywords_de <- c("defekt", "defect", "defeckt", "startet nicht", "starttet nicht", "gebrochen", "lampe leuchtet", "für export", "fur export", "gerausche", "geräusche", "gerräusche", "angebrochen", "angeschlagen", "beschädigt", "fehlerhaft", "lädiert", "nicht in Ordnung", "nicht mehr funktionierend", "nicht mehr gut", "schadhaft", "zerbrochen", "zerrissen", "kaputt" )
defective_keywords_2_de <- c("schäden", "problem", "schade", "probleme", "schaden")
ok_keywords_de <- c(paste("ohne", defective_keywords_2_de, sep = " "), paste("kein", defective_keywords_2_de, sep = " "), paste("keine", defective_keywords_2_de, sep = " "))
defective_keywords_fr <- c("témoin", "bruit", "défaut", "ne démarre pas", "cassé", "pour export", "pour l'export", "endommagé", "endommager", "endommage", "défectueux", "defectueux", "pas en bon état", "ne fonctionne plus", "cassé")
defective_keywords_2_fr <- c("dégâts", "dégats", "degâts", "degats", "problème", "probleme", "dommages")
ok_keywords_fr <- c(paste("sans", defective_keywords_2_fr, sep = " "), paste("pas de", defective_keywords_2_fr, sep = " "), paste("aucun", defective_keywords_2_fr, sep = " "))
defective_keywords_it <- c("spia", "rumore", "difetto", "non parte", "non si avvia", "rotto", "per l'esportazione", "per export", "danneggiato", "danneggiare", "danneggia", "difettoso", "non in buone condizioni", "non funziona più")
defective_keywords_2_it <- c("danni", "problemi", "problema")
ok_keywords_it <- c(paste("nessun", defective_keywords_2_it, sep = " "), paste("senza", defective_keywords_2_it, sep = " "))
defective_keywords_en <- c("defective", "does not start", "won't start", "broken", "light on", "for export", "noise", "faulty", "not working", "no longer working")
defective_keywords_2_en <- c("damage", "damaged", "problem", "problems")
ok_keywords_en <- c(paste("no", defective_keywords_2_en, sep = " "), paste("without", defective_keywords_2_en, sep = " "), paste("not", defective_keywords_2_en, sep = " "))
defective_keywords <- c(defective_keywords_de, defective_keywords_fr, defective_keywords_it, defective_keywords_en)
defective_keywords_2 <- c(defective_keywords_2_de, defective_keywords_2_fr, defective_keywords_2_it, defective_keywords_2_en)
ok_keywords <- c(ok_keywords_de, ok_keywords_fr, ok_keywords_it, ok_keywords_en)
data$defective <- logical(nrow(data))
for (keyword in defective_keywords_2) {
data$defective <- data$defective | grepl(keyword, data$description.text, ignore.case = TRUE)
}
for (keyword in defective_keywords_2) {
data$defective <- data$defective | grepl(keyword, data$subtitle, ignore.case = TRUE)
}
for (keyword in ok_keywords) {
data$defective <- data$defective & !grepl(keyword, data$description.text, ignore.case = TRUE)
}
for (keyword in ok_keywords) {
data$defective <- data$defective & !grepl(keyword, data$subtitle, ignore.case = TRUE)
}
for (keyword in defective_keywords) {
data$defective <- data$defective | grepl(keyword, data$description.text, ignore.case = TRUE)
}
for (keyword in defective_keywords) {
data$defective <- data$defective | grepl(keyword, data$subtitle, ignore.case = TRUE)
}
data$defective[data$accident] <- TRUE
data$fuel.type <- na_if(data$fuel.type, "-")
data$transmission <- na_if(data$transmission, "-")
data$drivetrain <- na_if(data$drivetrain, "-")
scraping_date <- data$created.date[order(data$created.date, decreasing = TRUE)[1]]
data$vehicle.age <- scraping_date - data$date
data$listing.age <- scraping_date - data$created.date
write.csv(data, file = "~/GitHub/Data_science/cleaned-data/golf2_cleaned.csv", row.names = FALSE)
library(tidyverse)
library(lubridate)
setwd("~/GitHub/Data_science/data")
data <- read.csv("skoda2.csv")
skoda2 <- read.csv("skoda2.csv")
data$price <- parse_number(data$price, locale = locale(grouping_mark = "'"))
data$kilometers <- parse_number(data$kilometers, locale = locale(grouping_mark = "'"))
data$listing.id <- parse_number(data$listing.id)
data$consumption <- na_if(data$consumption, "-")
data$consumption <- parse_number(data$consumption)
unique(data$consumption[order(data$consumption)])
data$consumption[data$consumption > 12] <- NA
data$power <- na_if(data$power, "-")
data$power <- parse_number(data$power)
data$expertise[data$expertise == "Non"] <- FALSE
data$expertise[data$expertise == "Oui"] <- TRUE
data$expertise <- as.logical(data$expertise)
data$accident[data$accident == "Non"] <- FALSE
data$accident[data$accident == "Oui"] <- TRUE
data$accident <- as.logical(data$accident)
data$warranty[data$warranty == "Non"] <- FALSE
data$warranty[data$warranty == "Oui"] <- TRUE
data$warranty <- as.logical(data$warranty)
data$new.price <- na_if(data$new.price, "Oui")
data$new.price <- na_if(data$new.price, "Non")
data$new.price <- parse_number(data$new.price, locale = locale(grouping_mark = "'"))
unique(data$new.price[order(data$new.price)])
data$new.price[data$new.price < 5000] <- NA
data <- data %>% select(-web.scraper.order, -web.scraper.start.url, -page, -annonce.link)
unique(data$date[order(data$date)])
data$date[1584] <- NA
data$date <- data$date |>
format(format = "%m.%Y") |>
parse_date(format = "%m.%Y")
data$created.date <- parse_date(data$created.date)
data$expertise.date <- data$expertise.date |>
format(format = "%d.%m.%Y") |>
parse_date(format = "%d.%m.%Y")
defective_keywords_de <- c("defekt", "defect", "defeckt", "startet nicht", "starttet nicht", "gebrochen", "lampe leuchtet", "für export", "fur export", "gerausche", "geräusche", "gerräusche", "angebrochen", "angeschlagen", "beschädigt", "fehlerhaft", "lädiert", "nicht in Ordnung", "nicht mehr funktionierend", "nicht mehr gut", "schadhaft", "zerbrochen", "zerrissen", "kaputt" )
defective_keywords_2_de <- c("schäden", "problem", "schade", "probleme", "schaden")
ok_keywords_de <- c(paste("ohne", defective_keywords_2_de, sep = " "), paste("kein", defective_keywords_2_de, sep = " "), paste("keine", defective_keywords_2_de, sep = " "))
defective_keywords_fr <- c("témoin", "bruit", "défaut", "ne démarre pas", "cassé", "pour export", "pour l'export", "endommagé", "endommager", "endommage", "défectueux", "defectueux", "pas en bon état", "ne fonctionne plus", "cassé")
defective_keywords_2_fr <- c("dégâts", "dégats", "degâts", "degats", "problème", "probleme", "dommages")
ok_keywords_fr <- c(paste("sans", defective_keywords_2_fr, sep = " "), paste("pas de", defective_keywords_2_fr, sep = " "), paste("aucun", defective_keywords_2_fr, sep = " "))
defective_keywords_it <- c("spia", "rumore", "difetto", "non parte", "non si avvia", "rotto", "per l'esportazione", "per export", "danneggiato", "danneggiare", "danneggia", "difettoso", "non in buone condizioni", "non funziona più")
defective_keywords_2_it <- c("danni", "problemi", "problema")
ok_keywords_it <- c(paste("nessun", defective_keywords_2_it, sep = " "), paste("senza", defective_keywords_2_it, sep = " "))
defective_keywords_en <- c("defective", "does not start", "won't start", "broken", "light on", "for export", "noise", "faulty", "not working", "no longer working")
defective_keywords_2_en <- c("damage", "damaged", "problem", "problems")
ok_keywords_en <- c(paste("no", defective_keywords_2_en, sep = " "), paste("without", defective_keywords_2_en, sep = " "), paste("not", defective_keywords_2_en, sep = " "))
defective_keywords <- c(defective_keywords_de, defective_keywords_fr, defective_keywords_it, defective_keywords_en)
defective_keywords_2 <- c(defective_keywords_2_de, defective_keywords_2_fr, defective_keywords_2_it, defective_keywords_2_en)
ok_keywords <- c(ok_keywords_de, ok_keywords_fr, ok_keywords_it, ok_keywords_en)
data$defective <- logical(nrow(data))
for (keyword in defective_keywords_2) {
data$defective <- data$defective | grepl(keyword, data$description.text, ignore.case = TRUE)
}
for (keyword in defective_keywords_2) {
data$defective <- data$defective | grepl(keyword, data$subtitle, ignore.case = TRUE)
}
for (keyword in ok_keywords) {
data$defective <- data$defective & !grepl(keyword, data$description.text, ignore.case = TRUE)
}
for (keyword in ok_keywords) {
data$defective <- data$defective & !grepl(keyword, data$subtitle, ignore.case = TRUE)
}
for (keyword in defective_keywords) {
data$defective <- data$defective | grepl(keyword, data$description.text, ignore.case = TRUE)
}
for (keyword in defective_keywords) {
data$defective <- data$defective | grepl(keyword, data$subtitle, ignore.case = TRUE)
}
data$defective[data$accident] <- TRUE
write.csv(data, file = "~/GitHub/Data_science/cleaned-data/skoda2_cleaned.csv", row.names = FALSE)
data$fuel.type <- na_if(data$fuel.type, "-")
data$transmission <- na_if(data$transmission, "-")
data$drivetrain <- na_if(data$drivetrain, "-")
scraping_date <- data$created.date[order(data$created.date, decreasing = TRUE)[1]]
data$vehicle.age <- scraping_date - data$date
data$listing.age <- scraping_date - data$created.date
write.csv(data, file = "~/GitHub/Data_science/cleaned-data/golf2_cleaned.csv", row.names = FALSE)
library(tidyverse)
library(lubridate)
setwd("~/GitHub/Data_science/data")
data <- read.csv("toyota.csv")
toyota <- read.csv("toyota.csv")
data$price <- parse_number(data$price, locale = locale(grouping_mark = "'"))
data$kilometers <- parse_number(data$kilometers, locale = locale(grouping_mark = "'"))
data$listing.id <- parse_number(data$listing.id)
data$consumption <- na_if(data$consumption, "-")
data$consumption <- parse_number(data$consumption)
data$power <- na_if(data$power, "-")
data$power <- parse_number(data$power)
data$expertise[data$expertise == "Non"] <- FALSE
data$expertise[data$expertise == "Oui"] <- TRUE
data$expertise <- as.logical(data$expertise)
data$accident[data$accident == "Non"] <- FALSE
data$accident[data$accident == "Oui"] <- TRUE
data$accident <- as.logical(data$accident)
data$warranty[data$warranty == "Non"] <- FALSE
data$warranty[data$warranty == "Oui"] <- TRUE
data$warranty <- as.logical(data$warranty)
data$new.price <- na_if(data$new.price, "Oui")
data$new.price <- na_if(data$new.price, "Non")
data$new.price <- parse_number(data$new.price, locale = locale(grouping_mark = "'"))
unique(data$new.price[order(data$new.price)])
data$new.price[data$new.price < 5000] <- NA
data <- data[-c(1:4)]
unique(data$date[order(data$date)])
data$date <- data$date |>
format(format = "%m.%Y") |>
parse_date(format = "%m.%Y")
data$created.date <- parse_date(data$created.date)
data$expertise.date <- data$expertise.date |>
format(format = "%d.%m.%Y") |>
parse_date(format = "%d.%m.%Y")
defective_keywords_de <- c("defekt", "defect", "defeckt", "startet nicht", "starttet nicht", "gebrochen", "lampe leuchtet", "für export", "fur export", "gerausche", "geräusche", "gerräusche", "angebrochen", "angeschlagen", "beschädigt", "fehlerhaft", "lädiert", "nicht in Ordnung", "nicht mehr funktionierend", "nicht mehr gut", "schadhaft", "zerbrochen", "zerrissen", "kaputt" )
defective_keywords_2_de <- c("schäden", "problem", "schade", "probleme", "schaden")
ok_keywords_de <- c(paste("ohne", defective_keywords_2_de, sep = " "), paste("kein", defective_keywords_2_de, sep = " "), paste("keine", defective_keywords_2_de, sep = " "))
defective_keywords_fr <- c("témoin", "bruit", "défaut", "ne démarre pas", "cassé", "pour export", "pour l'export", "endommagé", "endommager", "endommage", "défectueux", "defectueux", "pas en bon état", "ne fonctionne plus", "cassé")
defective_keywords_2_fr <- c("dégâts", "dégats", "degâts", "degats", "problème", "probleme", "dommages")
ok_keywords_fr <- c(paste("sans", defective_keywords_2_fr, sep = " "), paste("pas de", defective_keywords_2_fr, sep = " "), paste("aucun", defective_keywords_2_fr, sep = " "))
defective_keywords_it <- c("spia", "rumore", "difetto", "non parte", "non si avvia", "rotto", "per l'esportazione", "per export", "danneggiato", "danneggiare", "danneggia", "difettoso", "non in buone condizioni", "non funziona più")
defective_keywords_2_it <- c("danni", "problemi", "problema")
ok_keywords_it <- c(paste("nessun", defective_keywords_2_it, sep = " "), paste("senza", defective_keywords_2_it, sep = " "))
defective_keywords_en <- c("defective", "does not start", "won't start", "broken", "light on", "for export", "noise", "faulty", "not working", "no longer working")
defective_keywords_2_en <- c("damage", "damaged", "problem", "problems")
ok_keywords_en <- c(paste("no", defective_keywords_2_en, sep = " "), paste("without", defective_keywords_2_en, sep = " "), paste("not", defective_keywords_2_en, sep = " "))
defective_keywords <- c(defective_keywords_de, defective_keywords_fr, defective_keywords_it, defective_keywords_en)
defective_keywords_2 <- c(defective_keywords_2_de, defective_keywords_2_fr, defective_keywords_2_it, defective_keywords_2_en)
ok_keywords <- c(ok_keywords_de, ok_keywords_fr, ok_keywords_it, ok_keywords_en)
data$defective <- logical(nrow(data))
for (keyword in defective_keywords_2) {
data$defective <- data$defective | grepl(keyword, data$description.text, ignore.case = TRUE)
}
for (keyword in defective_keywords_2) {
data$defective <- data$defective | grepl(keyword, data$subtitle, ignore.case = TRUE)
}
for (keyword in ok_keywords) {
data$defective <- data$defective & !grepl(keyword, data$description.text, ignore.case = TRUE)
}
for (keyword in ok_keywords) {
data$defective <- data$defective & !grepl(keyword, data$subtitle, ignore.case = TRUE)
}
for (keyword in defective_keywords) {
data$defective <- data$defective | grepl(keyword, data$description.text, ignore.case = TRUE)
}
for (keyword in defective_keywords) {
data$defective <- data$defective | grepl(keyword, data$subtitle, ignore.case = TRUE)
}
data$defective[data$accident] <- TRUE
data$fuel.type <- na_if(data$fuel.type, "-")
data$transmission <- na_if(data$transmission, "-")
data$drivetrain <- na_if(data$drivetrain, "-")
scraping_date <- data$created.date[order(data$created.date, decreasing = TRUE)[1]]
data$vehicle.age <- scraping_date - data$date
data$listing.age <- scraping_date - data$created.date
write.csv(data, file = "~/GitHub/Data_science/cleaned-data/golf2_cleaned.csv", row.names = FALSE)
library(tidyverse)
library(lubridate)
setwd("~/GitHub/Data_science/data")
data <- read.csv("volvo2.csv")
volvo2 <- read.csv("volvo2.csv")
data$price <- parse_number(data$price, locale = locale(grouping_mark = "'"))
data$kilometers <- parse_number(data$kilometers, locale = locale(grouping_mark = "'"))
data$listing.id <- parse_number(data$listing.id)
data$consumption <- na_if(data$consumption, "-")
data$consumption <- parse_number(data$consumption)
unique(data$consumption[order(data$consumption)])
data$consumption[data$consumption > 12] <- NA
data$power <- na_if(data$power, "-")
data$power <- parse_number(data$power)
data$expertise[data$expertise == "Non"] <- FALSE
data$expertise[data$expertise == "Oui"] <- TRUE
data$expertise <- as.logical(data$expertise)
data$accident[data$accident == "Non"] <- FALSE
data$accident[data$accident == "Oui"] <- TRUE
data$accident <- as.logical(data$accident)
data$warranty[data$warranty == "Non"] <- FALSE
data$warranty[data$warranty == "Oui"] <- TRUE
data$warranty <- as.logical(data$warranty)
data$new.price <- na_if(data$new.price, "Oui")
data$new.price <- na_if(data$new.price, "Non")
data$new.price <- parse_number(data$new.price, locale = locale(grouping_mark = "'"))
unique(data$new.price[order(data$new.price)])
data$new.price[data$new.price < 5000] <- NA
data <- data[-c(1:4)]
unique(data$date[order(data$date)])
data$date <- data$date |>
format(format = "%m.%Y") |>
parse_date(format = "%m.%Y")
data$created.date <- parse_date(data$created.date)
data$expertise.date <- data$expertise.date |>
format(format = "%d.%m.%Y") |>
parse_date(format = "%d.%m.%Y")
defective_keywords_de <- c("defekt", "defect", "defeckt", "startet nicht", "starttet nicht", "gebrochen", "lampe leuchtet", "für export", "fur export", "gerausche", "geräusche", "gerräusche", "angebrochen", "angeschlagen", "beschädigt", "fehlerhaft", "lädiert", "nicht in Ordnung", "nicht mehr funktionierend", "nicht mehr gut", "schadhaft", "zerbrochen", "zerrissen", "kaputt" )
defective_keywords_2_de <- c("schäden", "problem", "schade", "probleme", "schaden")
ok_keywords_de <- c(paste("ohne", defective_keywords_2_de, sep = " "), paste("kein", defective_keywords_2_de, sep = " "), paste("keine", defective_keywords_2_de, sep = " "))
defective_keywords_fr <- c("témoin", "bruit", "défaut", "ne démarre pas", "cassé", "pour export", "pour l'export", "endommagé", "endommager", "endommage", "défectueux", "defectueux", "pas en bon état", "ne fonctionne plus", "cassé")
defective_keywords_2_fr <- c("dégâts", "dégats", "degâts", "degats", "problème", "probleme", "dommages")
ok_keywords_fr <- c(paste("sans", defective_keywords_2_fr, sep = " "), paste("pas de", defective_keywords_2_fr, sep = " "), paste("aucun", defective_keywords_2_fr, sep = " "))
defective_keywords_it <- c("spia", "rumore", "difetto", "non parte", "non si avvia", "rotto", "per l'esportazione", "per export", "danneggiato", "danneggiare", "danneggia", "difettoso", "non in buone condizioni", "non funziona più")
defective_keywords_2_it <- c("danni", "problemi", "problema")
ok_keywords_it <- c(paste("nessun", defective_keywords_2_it, sep = " "), paste("senza", defective_keywords_2_it, sep = " "))
defective_keywords_en <- c("defective", "does not start", "won't start", "broken", "light on", "for export", "noise", "faulty", "not working", "no longer working")
defective_keywords_2_en <- c("damage", "damaged", "problem", "problems")
ok_keywords_en <- c(paste("no", defective_keywords_2_en, sep = " "), paste("without", defective_keywords_2_en, sep = " "), paste("not", defective_keywords_2_en, sep = " "))
defective_keywords <- c(defective_keywords_de, defective_keywords_fr, defective_keywords_it, defective_keywords_en)
defective_keywords_2 <- c(defective_keywords_2_de, defective_keywords_2_fr, defective_keywords_2_it, defective_keywords_2_en)
ok_keywords <- c(ok_keywords_de, ok_keywords_fr, ok_keywords_it, ok_keywords_en)
data$defective <- logical(nrow(data))
for (keyword in defective_keywords_2) {
data$defective <- data$defective | grepl(keyword, data$description.text, ignore.case = TRUE)
}
for (keyword in defective_keywords_2) {
data$defective <- data$defective | grepl(keyword, data$subtitle, ignore.case = TRUE)
}
for (keyword in ok_keywords) {
data$defective <- data$defective & !grepl(keyword, data$description.text, ignore.case = TRUE)
}
for (keyword in ok_keywords) {
data$defective <- data$defective & !grepl(keyword, data$subtitle, ignore.case = TRUE)
}
for (keyword in defective_keywords) {
data$defective <- data$defective | grepl(keyword, data$description.text, ignore.case = TRUE)
}
for (keyword in defective_keywords) {
data$defective <- data$defective | grepl(keyword, data$subtitle, ignore.case = TRUE)
}
data$defective[data$accident] <- TRUE
data$fuel.type <- na_if(data$fuel.type, "-")
data$transmission <- na_if(data$transmission, "-")
data$drivetrain <- na_if(data$drivetrain, "-")
scraping_date <- data$created.date[order(data$created.date, decreasing = TRUE)[1]]
data$vehicle.age <- scraping_date - data$date
data$listing.age <- scraping_date - data$created.date
write.csv(data, file = "~/GitHub/Data_science/cleaned-data/golf2_cleaned.csv", row.names = FALSE)
library(tidyverse)
setwd("~/GitHub/Data_science/cleaned-data")
data <- read.csv("golf2_cleaned.csv")
attach(data)
ggplot(data = data) +
geom_point(mapping = aes(x = date, y = price, color = factor(fuel.type)))
ggplot(data = data) +
geom_point(mapping = aes(x = date, y = price, color = factor(fuel.type), na.rm = TRUE))
ggplot(data = data) +
geom_point(mapping = aes(x = date, y = price, color = factor(fuel.type)), na.rm = TRUE)
ggplot(data = data, na.rm = TRUE) +
geom_point(mapping = aes(x = date, y = price, color = factor(fuel.type)), na.rm = TRUE)
ggplot(data = data) +
geom_point(mapping = aes(x = date, y = price, color = factor(fuel.type, na.rm = TRUE)))
rlang::last_trace()
ggplot(data = data) +
geom_point(mapping = aes(x = date, y = price, color = factor(fuel.type)))
View(data)
setwd("~/GitHub/Data_science/cleaned-data")
data <- read.csv("golf2_cleaned.csv")
View(data)
rm(data)
data <- read.csv("golf2_cleaned.csv")
View(golf2)
View(data)
