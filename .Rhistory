summary(model5)
model5 <- lm(data_no_expensive$price ~ data_no_expensive$vehicle.age + data_no_expensive$vehicle.age.squared + data_no_expensive$kilometers + data_no_expensive$kilometers.squared + data_no_expensive$power + data_no_expensive$warranty + data_no_expensive$diesel + data_no_expensive$manual + data_no_expensive$awd)
summary(model5)
sqrt(anova(model5)$"Mean Sq")[10]
sqrt(anova(model5)$"Mean Sq")[11]
sqrt(anova(model5)$"Mean Sq")[10]
ggplot(model5, aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
data_no_def <- filter(data, !defective)
model6 <- lm(data_no_def$price ~ data_no_def$vehicle.age + data_no_def$vehicle.age.squared + data_no_def$kilometers + data_no_def$kilometers.squared + data_no_def$power + data_no_def$expertise + data_no_def$warranty + data_no_def$diesel + data_no_def$manual + data_no_def$awd)
summary(model6)
anova(model6)
sqrt(anova(model6)$"Mean Sq")[12]
sqrt(anova(model6)$"Mean Sq")[11]
ggplot(model6, aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
model6_data <- select(data_no_def, c("price", "vehicle.age", "vehicle.age.squared", "kilometers", "kilometers.squared", "power", "expertise", "warranty", "diesel", "manual", "awd"))
cor_matrix_3 <- cor(model6_data, use = "complete.obs")
cor_matrix_3
corrplot(cor_matrix_3)
vif(model6)
model7 <- lm(data_no_def$price ~ data_no_def$kilometers + data_no_def$kilometers.squared + data_no_def$power + data_no_def$expertise + data_no_def$warranty + data_no_def$wagon + data_no_def$diesel + data_no_def$hybrid + data_no_def$manual + data_no_def$awd)
vif(model7)
model7 <- lm(data_no_def$price ~ data_no_def$kilometers + data_no_def$kilometers.squared + data_no_def$power + data_no_def$expertise + data_no_def$warranty + data_no_def$wagon + data_no_def$diesel + data_no_def$manual + data_no_def$awd)
vif(model7)
model7 <- lm(data_no_def$price ~ data_no_def$kilometers + data_no_def$kilometers.squared + data_no_def$power + data_no_def$expertise + data_no_def$warranty + data_no_def$diesel + data_no_def$manual + data_no_def$awd)
vif(model7)
model8 <- lm(data_no_def$price ~ data_no_def$vehicle.age + data_no_def$vehicle.age.squared + data_no_def$power + data_no_def$expertise + data_no_def$warranty + data_no_def$diesel + data_no_def$manual + data_no_def$awd)
vif(model8)
data_no_def <- data_no_def[complete.cases(data_no_def[,c("price", "vehicle.age", "vehicle.age.squared", "kilometers", "kilometers.squared", "power", "expertise", "warranty", "wagon", "diesel", "hybrid", "manual", "awd")]),]
data_no_def$residuals <- model6$residuals
data_no_def <- data_no_def[complete.cases(data_no_def[,c("price", "vehicle.age", "vehicle.age.squared", "kilometers", "kilometers.squared", "power", "expertise", "warranty", "wagon", "diesel", "hybrid", "manual", "awd")]),]
data_no_def$residuals <- model6$residuals
data_no_def$residuals
View(data_no_def)
data_no_def <- data_no_def |>
mutate(count = row_number()) |>
select(count, everything())
library(tidyverse)
library(corrplot)
library(Hmisc)
library(car)
setwd("~/GitHub/Data_science/cleaned-data")
data <- read.csv("skoda2_cleaned.csv")
skoda2_cleaned <- read.csv("skoda2_cleaned.csv")
attach(data)
data_numeric <- select(data, c("price", "vehicle.age", "kilometers", "power", "consumption"))
data_numeric
cor_matrix <- cor(data_numeric, use = "complete.obs")
cor_matrix
corrplot(cor_matrix)
summary(lm(price ~ consumption))
ggplot(data, aes(consumption, price)) +
geom_point() +
geom_smooth(method = lm) +
ylim(0, max(data$price))
summary(lm(price ~ vehicle.age))
ggplot(data, aes(vehicle.age, price)) +
geom_point() +
geom_smooth(method = lm) +
ylim(0, max(data$price))
ggplot(lm(price ~ vehicle.age), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
ggplot(data, aes(vehicle.age, price)) +
geom_point() +
geom_smooth(method = loess) +
ylim(0, max(data$price))
data$vehicle.age.squared <- (vehicle.age ^ 2)
attach(data)
summary(lm(price ~ vehicle.age + vehicle.age.squared))
ggplot(lm(price ~ vehicle.age + vehicle.age.squared), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
summary(lm(price ~ kilometers))
ggplot(data, aes(kilometers, price)) +
geom_point() +
geom_smooth(method = lm) +
ylim(0, max(data$price))
ggplot(lm(price ~ kilometers), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
data$kilometers.squared <- (kilometers ^ 2)
attach(data)
summary(lm(price ~ kilometers + kilometers.squared))
ggplot(lm(price ~ kilometers + kilometers.squared), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
summary(lm(price ~ power))
ggplot(data, aes(power, price)) +
geom_point() +
geom_smooth(method = lm) +
ylim(0, max(data$price))
model1 <- lm(price ~ vehicle.age + vehicle.age.squared + kilometers + kilometers.squared + power)
summary(model1)
ggplot(model1, aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
table(data$defective)[2]/table(data$defective)[1]
data_no_def <- filter(data, !defective)
model2 <- lm(data_no_def$price ~ data_no_def$vehicle.age + data_no_def$vehicle.age.squared + data_no_def$kilometers + data_no_def$kilometers.squared + data_no_def$power)
table(data$defective)[2]/nrow(data)
data_no_def <- filter(data, !defective)
model2 <- lm(data_no_def$price ~ data_no_def$vehicle.age + data_no_def$vehicle.age.squared + data_no_def$kilometers + data_no_def$kilometers.squared + data_no_def$power)
summary(model2)
ggplot(model2, aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
sqrt(anova(model1)$"Mean Sq")[6] # Sd model1
sqrt(anova(model2)$"Mean Sq")[6] # Sd model2
table(fuel.type)
table(body.type)
data$cabriolet <- body.type == "Cabriolet"
data$suv <- body.type == "Limousine SUV / Tout-terrain"
table(fuel.type)
data$diesel <- fuel.type == "Diesel"
data$hybrid <- ifelse(fuel.type == "Hybride léger essence/électrique" |
fuel.type == "Hybride rechargeable essence/électrique" |
fuel.type == "Hybride léger diesel/électrique",
TRUE, FALSE)
data$natural.gas <- fuel.type == "Gaz naturel (CNG) / Essence"
table(transmission)
data$manual <- ifelse(transmission == "Automatique" |
transmission == "Boîte manuelle automatisée" |
transmission == "Boîte automatique variable",
FALSE, TRUE)
table(drivetrain)
data$awd <- drivetrain == "4 roues motrices"
summary(lm(price ~ expertise)) # Significant
summary(lm(price ~ warranty)) # Significant
summary(lm(price ~ suv)) # NOT Significant
attach(data)
summary(lm(price ~ expertise)) # Significant
summary(lm(price ~ warranty)) # Significant
summary(lm(price ~ suv)) # NOT Significant
View(data)
table(body.type)
data$cabriolet <- body.type == "Cabriolet"
data$suv <- body.type == "SUV / Tout-terrain"
data$sedan <- body.type == "Limousine"
attach(data)
summary(lm(price ~ expertise)) # Significant
summary(lm(price ~ warranty)) # Significant
summary(lm(price ~ suv)) # NOT Significant
summary(lm(price ~ sedan)) # NOT Significant
summary(lm(price ~ sedan)) # Significant
summary(lm(price ~ cabriolet)) # NOT Significant
summary(lm(price ~ small.car)) # NOT Significant
summary(lm(price ~ cabriolet)) # NOT Significant
summary(lm(price ~ diesel)) # Significant
summary(lm(price ~ hybrid)) # Significant
summary(lm(price ~ hybrid)) # Significant
summary(lm(price ~ natural.gas)) # NOT Significant
summary(lm(price ~ electric)) # NOT Significant
summary(lm(price ~ manual)) # Significant
summary(lm(price ~ awd)) # Significant
model3 <- lm(price ~ expertise + warranty + sedan + diesel + hybrid + manual + awd)
summary(model3)
model4 <- lm(price ~ vehicle.age + vehicle.age.squared + kilometers + kilometers.squared + power + expertise + warranty + sedan + diesel + hybrid + manual + awd)
summary(model4)
model4 <- lm(price ~ vehicle.age + vehicle.age.squared + kilometers + kilometers.squared + power + expertise + warranty + diesel + hybrid + manual)
summary(model4)
ggplot(data, aes(vehicle.age, price)) +
geom_point() +
geom_smooth(method = lm) +
ylim(0, max(data$price))
ggplot(lm(price ~ vehicle.age), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
summary(model4)
d
ggplot(model4, aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
sqrt(anova(model4)$"Mean Sq")[11]
sqrt(anova(model4)$"Mean Sq")[12]
sqrt(anova(model4)$"Mean Sq")[11]
anova(model4)
model4_data <- select(data, c("price", "vehicle.age", "vehicle.age.squared", "kilometers", "kilometers.squared", "power", "expertise", "warranty", "diesel", "manual", "awd"))
cor_matrix_2 <- cor(model4_data, use = "complete.obs")
cor_matrix_2
corrplot(cor_matrix_2)
data_no_expensive <- filter(data, price < 40000)
nrow(data_no_expensive)/nrow(data)
model4_data <- select(data, c("price", "vehicle.age", "vehicle.age.squared", "kilometers", "kilometers.squared", "power", "expertise", "warranty", "diesel", "hybrid", "manual"))
cor_matrix_2 <- cor(model4_data, use = "complete.obs")
cor_matrix_2
corrplot(cor_matrix_2)
model5 <- lm(data_no_expensive$price ~ data_no_expensive$vehicle.age + data_no_expensive$vehicle.age.squared + data_no_expensive$kilometers + data_no_expensive$kilometers.squared + data_no_expensive$power + data_no_expensive$expertise + data_no_expensive$warranty + data_no_expensive$diesel + data_no_expensive$hybrid + data_no_expensive$manual)
summary(model5)
model5 <- lm(data_no_expensive$price ~ data_no_expensive$vehicle.age + data_no_expensive$vehicle.age.squared + data_no_expensive$kilometers + data_no_expensive$kilometers.squared + data_no_expensive$power + data_no_expensive$expertise + data_no_expensive$warranty + data_no_expensive$diesel + data_no_expensive$manual)
summary(model5)
sqrt(anova(model5)$"Mean Sq")[10]
sqrt(anova(model4)$"Mean Sq")[11]
ggplot(model5, aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
data_no_def <- filter(data, !defective)
model6 <- lm(data_no_def$price ~ data_no_def$vehicle.age + data_no_def$vehicle.age.squared + data_no_def$kilometers + data_no_def$kilometers.squared + data_no_def$power + data_no_def$expertise + data_no_def$warranty + data_no_def$diesel + data_no_def$hybrid + data_no_def$manual)
summary(model6)
anova(model6)
sqrt(anova(model6)$"Mean Sq")[11]
ggplot(model6, aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
model6_data <- select(data_no_def, c("price", "vehicle.age", "vehicle.age.squared", "kilometers", "kilometers.squared", "power", "expertise", "warranty", "diesel", "hybrid", "manual"))
cor_matrix_3 <- cor(model6_data, use = "complete.obs")
cor_matrix_3
corrplot(cor_matrix_3)
vif(model6)
model7 <- lm(data_no_def$price ~ data_no_def$kilometers + data_no_def$kilometers.squared + data_no_def$power + data_no_def$expertise + data_no_def$warranty + data_no_def$diesel + data_no_def$hybrid + data_no_def$manual)
vif(model7)
model8 <- lm(data_no_def$price ~ data_no_def$vehicle.age + data_no_def$vehicle.age.squared + data_no_def$power + data_no_def$expertise + data_no_def$warranty + data_no_def$diesel + data_no_def$hybrid + data_no_def$manual)
vif(model8)
summary(model8)
data_no_def <- data_no_def[complete.cases(data_no_def[,c("price", "vehicle.age", "vehicle.age.squared", "kilometers", "kilometers.squared", "power", "expertise", "warranty", "diesel", "hybrid", "manual")]),]
data_no_def$residuals <- model6$residuals
data_no_def <- data_no_def |>
mutate(count = row_number()) |>
select(count, everything())
library(tidyverse)
library(corrplot)
library(Hmisc)
library(car)
setwd("~/GitHub/Data_science/cleaned-data")
data <- read.csv("volvo2_cleaned.csv")
volvo2_cleaned <- read.csv("volvo2_cleaned.csv")
attach(data)
data_numeric
data_numeric <- select(data, c("price", "vehicle.age", "kilometers", "power", "consumption"))
cor_matrix
corrplot(cor_matrix)
cor_matrix <- cor(data_numeric, use = "complete.obs")
summary(lm(price ~ consumption))
ggplot(data, aes(consumption, price)) +
geom_point() +
geom_smooth(method = lm) +
ylim(0, max(data$price))
summary(lm(price ~ vehicle.age))
ggplot(data, aes(vehicle.age, price)) +
geom_point() +
geom_smooth(method = lm) +
ylim(0, max(data$price))
ggplot(lm(price ~ vehicle.age), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
ggplot(data, aes(vehicle.age, price)) +
geom_point() +
geom_smooth(method = loess) +
ylim(0, max(data$price))
data$vehicle.age.squared <- (vehicle.age ^ 2)
attach(data)
summary(lm(price ~ vehicle.age + vehicle.age.squared))
ggplot(lm(price ~ vehicle.age + vehicle.age.squared), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
summary(lm(price ~ kilometers))
ggplot(data, aes(kilometers, price)) +
geom_point() +
geom_smooth(method = lm) +
ylim(0, max(data$price))
ggplot(lm(price ~ kilometers), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
data$kilometers.squared <- (kilometers ^ 2)
attach(data)
summary(lm(price ~ kilometers + kilometers.squared))
ggplot(lm(price ~ kilometers + kilometers.squared), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
summary(lm(price ~ power))
ggplot(data, aes(power, price)) +
geom_point() +
geom_smooth(method = lm) +
ylim(0, max(data$price))
ggplot(data, aes(consumption, price)) +
geom_point() +
geom_smooth(method = lm) +
ylim(0, max(data$price))
model1 <- lm(price ~ vehicle.age + vehicle.age.squared + kilometers + kilometers.squared + power + consumption)
summary(model1)
summary(lm(price ~ consumption))
ggplot(model1, aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
table(data$defective)[2]/nrow(data)
data_no_def <- filter(data, !defective)
model2 <- lm(data_no_def$price ~ data_no_def$vehicle.age + data_no_def$vehicle.age.squared + data_no_def$kilometers + data_no_def$kilometers.squared + data_no_def$power)
model2 <- lm(data_no_def$price ~ data_no_def$vehicle.age + data_no_def$vehicle.age.squared + data_no_def$kilometers + data_no_def$kilometers.squared + data_no_def$power, data_no_def$consumption)
model2 <- lm(data_no_def$price ~ data_no_def$vehicle.age + data_no_def$vehicle.age.squared + data_no_def$kilometers + data_no_def$kilometers.squared + data_no_def$power, data_no_def$consumption)
View(data_no_def)
data_no_def <- filter(data, !defective)
model2 <- lm(data_no_def$price ~ data_no_def$vehicle.age + data_no_def$vehicle.age.squared + data_no_def$kilometers + data_no_def$kilometers.squared + data_no_def$power, data_no_def$consumption)
rm(model2)
model2 <- lm(data_no_def$price ~ data_no_def$vehicle.age + data_no_def$vehicle.age.squared + data_no_def$kilometers + data_no_def$kilometers.squared + data_no_def$power, data_no_def$consumption)
data_no_def <- filter(data, !defective)
model2 <- lm(data_no_def$price ~ data_no_def$vehicle.age + data_no_def$vehicle.age.squared + data_no_def$kilometers + data_no_def$kilometers.squared + data_no_def$power, data_no_def$consumption)
library(tidyverse)
library(corrplot)
library(Hmisc)
library(car)
setwd("~/GitHub/Data_science/cleaned-data")
data <- read.csv("volvo2_cleaned.csv")
volvo2_cleaned <- read.csv("volvo2_cleaned.csv")
attach(data)
data_numeric <- select(data, c("price", "vehicle.age", "kilometers", "power", "consumption"))
data_numeric
cor_matrix <- cor(data_numeric, use = "complete.obs")
cor_matrix
corrplot(cor_matrix)
summary(lm(price ~ consumption))
ggplot(data, aes(consumption, price)) +
geom_point() +
geom_smooth(method = lm) +
ylim(0, max(data$price))
summary(lm(price ~ vehicle.age))
ggplot(data, aes(vehicle.age, price)) +
geom_point() +
geom_smooth(method = lm) +
ylim(0, max(data$price))
ggplot(lm(price ~ vehicle.age), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
ggplot(data, aes(vehicle.age, price)) +
geom_point() +
geom_smooth(method = loess) +
ylim(0, max(data$price))
data$vehicle.age.squared <- (vehicle.age ^ 2)
attach(data)
summary(lm(price ~ vehicle.age + vehicle.age.squared))
ggplot(lm(price ~ vehicle.age + vehicle.age.squared), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
summary(lm(price ~ kilometers))
ggplot(data, aes(kilometers, price)) +
geom_point() +
geom_smooth(method = lm) +
ylim(0, max(data$price))
ggplot(lm(price ~ kilometers), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
data$kilometers.squared <- (kilometers ^ 2)
attach(data)
summary(lm(price ~ kilometers + kilometers.squared))
ggplot(lm(price ~ kilometers + kilometers.squared), aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
summary(lm(price ~ power))
ggplot(data, aes(power, price)) +
geom_point() +
geom_smooth(method = lm) +
ylim(0, max(data$price))
model1 <- lm(price ~ vehicle.age + vehicle.age.squared + kilometers + kilometers.squared + power + consumption)
summary(model1)
ggplot(model1, aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
table(data$defective)[2]/nrow(data)
data_no_def <- filter(data, !defective)
model2 <- lm(data_no_def$price ~ data_no_def$vehicle.age + data_no_def$vehicle.age.squared + data_no_def$kilometers + data_no_def$kilometers.squared + data_no_def$power, data_no_def$consumption)
summary(model2)
View(data)
View(data_no_def)
model2 <- lm(data_no_def$price ~ data_no_def$vehicle.age + data_no_def$vehicle.age.squared + data_no_def$kilometers + data_no_def$kilometers.squared + data_no_def$power + data_no_def$consumption)
summary(model2)
ggplot(model2, aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
sqrt(anova(model1)$"Mean Sq")[6] # Sd model1
sqrt(anova(model1)$"Mean Sq")[7] # Sd model1
sqrt(anova(model2)$"Mean Sq")[7] # Sd model2
table(body.type)
table(fuel.type)
data$diesel <- fuel.type == "Diesel"
data$hybrid <- ifelse(fuel.type == "Hybride léger essence/électrique" |
fuel.type == "Hybride rechargeable essence/électrique" |
fuel.type == "Hybride léger diesel/électrique",
TRUE, FALSE)
table(transmission)
data$manual <- ifelse(transmission == "Automatique" |
transmission == "Boîte manuelle automatisée" |
transmission == "Boîte automatique variable",
FALSE, TRUE)
table(drivetrain)
data$fwd <- drivetrain == "Traction avant"
attach(data)
summary(lm(price ~ expertise)) # Significant
summary(lm(price ~ warranty)) # Significant
summary(lm(price ~ diesel)) # Significant
summary(lm(price ~ hybrid)) # Significant
summary(lm(price ~ manual)) # Significant
summary(lm(price ~ fwd)) # Significant
model3 <- lm(price ~ expertise + warranty + diesel + hybrid + manual + fwd)
summary(model3)
model4 <- lm(price ~ vehicle.age + vehicle.age.squared + kilometers + kilometers.squared + power + consumption + expertise + warranty + diesel + hybrid + manual + fwd)
summary(model4)
model4 <- lm(price ~ vehicle.age + vehicle.age.squared + kilometers + kilometers.squared + power + consumption + warranty + diesel + hybrid + manual + fwd)
summary(model4)
model4 <- lm(price ~ vehicle.age + vehicle.age.squared + kilometers + kilometers.squared + power + consumption + warranty + diesel + hybrid + manual)
summary(model4)
model4 <- lm(price ~ vehicle.age + vehicle.age.squared + kilometers + kilometers.squared + power + consumption + warranty + hybrid + manual)
summary(model4)
model4 <- lm(price ~ vehicle.age + vehicle.age.squared + kilometers + kilometers.squared + power + consumption + hybrid + manual)
summary(model4)
model4 <- lm(price ~ vehicle.age + vehicle.age.squared + kilometers + kilometers.squared + power + consumption + hybrid)
summary(model4)
model4 <- lm(price ~ vehicle.age + vehicle.age.squared + kilometers + kilometers.squared + power + consumption + expertise + warranty + diesel + hybrid + manual + fwd)
summary(model4)
model4 <- lm(price ~ vehicle.age + vehicle.age.squared + kilometers + kilometers.squared + power + consumption + expertise + warranty + diesel + hybrid + manual + fwd)
summary(model4)
model4 <- lm(price ~ vehicle.age + vehicle.age.squared + kilometers + kilometers.squared + power + consumption + hybrid)
summary(model4)
ggplot(model4, aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
sqrt(anova(model4)$"Mean Sq")[11]
summary(model4)
anova(model4)
sqrt(anova(model4)$"Mean Sq")[8]
anova(model4)
model4_data <- select(data, c("price", "vehicle.age", "vehicle.age.squared", "kilometers", "kilometers.squared", "power", "expertise", "warranty", "diesel", "manual", "awd"))
model4_data <- select(data, c("price", "vehicle.age", "vehicle.age.squared", "kilometers", "kilometers.squared", "power", "consumption", "hybrid"))
cor_matrix_2 <- cor(model4_data, use = "complete.obs")
cor_matrix_2
corrplot(cor_matrix_2)
ggplot(model4, aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
sqrt(anova(model4)$"Mean Sq")[8]
anova(model4)
model4_data <- select(data, c("price", "vehicle.age", "vehicle.age.squared", "kilometers", "kilometers.squared", "power", "consumption", "hybrid"))
cor_matrix_2 <- cor(model4_data, use = "complete.obs")
cor_matrix_2
corrplot(cor_matrix_2)
ggplot(model4, aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
data_no_expensive <- filter(data, price < 60000)
nrow(data_no_expensive)/nrow(data)
model5 <- lm(data_no_expensive$price ~ data_no_expensive$vehicle.age + data_no_expensive$vehicle.age.squared + data_no_expensive$kilometers + data_no_expensive$kilometers.squared + data_no_expensive$power + data_no_expensive$consumption + data_no_expensive$hybrid)
summary(model5)
sqrt(anova(model5)$"Mean Sq")[10]
sqrt(anova(model5)$"Mean Sq")[8]
sqrt(anova(model4)$"Mean Sq")[8]
ggplot(model5, aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
ggplot(model4, aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
ggplot(model5, aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
model6 <- lm(data_no_def$price ~ data_no_def$vehicle.age + data_no_def$vehicle.age.squared + data_no_def$kilometers + data_no_def$kilometers.squared + data_no_def$power + data_no_def$consumption + data_no_def$hybrid)
data_no_def <- filter(data, !defective)
model6 <- lm(data_no_def$price ~ data_no_def$vehicle.age + data_no_def$vehicle.age.squared + data_no_def$kilometers + data_no_def$kilometers.squared + data_no_def$power + data_no_def$consumption + data_no_def$hybrid)
summary(model6)
anova(model6)
sqrt(anova(model6)$"Mean Sq")[8]
ggplot(model6, aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linewidth = 1) +
geom_smooth()
model6_data <- select(data_no_def, c("price", "vehicle.age", "vehicle.age.squared", "kilometers", "kilometers.squared", "power", "consumption", "hybrid"))
cor_matrix_3 <- cor(model6_data, use = "complete.obs")
cor_matrix_3
corrplot(cor_matrix_3)
vif(model6)
model7 <- lm(data_no_def$price ~ data_no_def$kilometers + data_no_def$kilometers.squared + data_no_def$power + data_no_def$consumption + data_no_def$hybrid)
vif(model7)
summary(model7)
model7 <- lm(data_no_def$price ~ data_no_def$vehicle.age + data_no_def$vehicle.age.squared + data_no_def$power + data_no_def$consumption + data_no_def$hybrid)
vif(model8)
model7 <- lm(data_no_def$price ~ data_no_def$kilometers + data_no_def$kilometers.squared + data_no_def$power + data_no_def$consumption + data_no_def$hybrid)
vif(model7)
summary(model7)
model8 <- lm(data_no_def$price ~ data_no_def$vehicle.age + data_no_def$vehicle.age.squared + data_no_def$power + data_no_def$consumption + data_no_def$hybrid)
vif(model8)
summary(model8)
data_no_def <- data_no_def[complete.cases(data_no_def[,c("price", "vehicle.age", "vehicle.age.squared", "kilometers", "kilometers.squared", "power", "consumption", "hybrid")]),]
data_no_def$residuals <- model6$residuals
