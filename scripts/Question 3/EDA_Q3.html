<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>EDA Q3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="EDA_Q3_files/libs/clipboard/clipboard.min.js"></script>
<script src="EDA_Q3_files/libs/quarto-html/quarto.js"></script>
<script src="EDA_Q3_files/libs/quarto-html/popper.min.js"></script>
<script src="EDA_Q3_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="EDA_Q3_files/libs/quarto-html/anchor.min.js"></script>
<link href="EDA_Q3_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="EDA_Q3_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="EDA_Q3_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="EDA_Q3_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="EDA_Q3_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="EDA_Q3_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="EDA_Q3_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">EDA Q3</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="how-do-different-vehicle-features-affect-depreciation" class="level3">
<h3 class="anchored" data-anchor-id="how-do-different-vehicle-features-affect-depreciation">2.3 How do different vehicle features affect depreciation ?</h3>
<p>In this part, we will look at graphs related to the depreciation of our vehicles and identify various trends, as well as correlation matrices to observe the correlations between depreciation and vehicle age and mileage, as well as other immovable factors such as power and fuel consumption.</p>
<section id="filtering-data" class="level4">
<h4 class="anchored" data-anchor-id="filtering-data">2.3.1 Filtering data</h4>
<p>Firstly, we need to filter our data to keep only the observations where the new price of the vehicle is available. When scraping our data, only a portion of the total listings had the vehicleâ€™s new age displayed, as it is an optional input for the seller. This reduces our sample sizes a large amount, especially for the Toyota Yaris data set. Below is a table displaying these reductions in sample sizes.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Question 3: How do different vehicle features affect depreciation ?</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggtext)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"~/GitHub/Data_science/cleaned-data"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>golf <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"golf_models_data.csv"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>audi <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"audi_models_data.csv"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>skoda <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"skoda_models_data.csv"</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>volvo <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"volvo_models_data.csv"</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>toyota <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"toyota_models_data.csv"</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Table for reductions in sample size</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>sample_sizes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"VW Golf"</span> <span class="ot">=</span> <span class="fu">nrow</span>(golf),</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Audi A3"</span> <span class="ot">=</span> <span class="fu">nrow</span>(audi),</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Skoda Octavia"</span> <span class="ot">=</span> <span class="fu">nrow</span>(skoda),</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Volvo XC60"</span> <span class="ot">=</span> <span class="fu">nrow</span>(volvo),</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Toyota Yaris"</span> <span class="ot">=</span> <span class="fu">nrow</span>(toyota)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Depreciation variables</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co"># We filter to remove NAs from new price for this part</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co"># golf</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>golf <span class="ot">&lt;-</span> golf <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(new.price))</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>golf<span class="sc">$</span>depreciation <span class="ot">=</span> golf<span class="sc">$</span>new.price <span class="sc">-</span> golf<span class="sc">$</span>price</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>golf<span class="sc">$</span>rel_dep <span class="ot">=</span> golf<span class="sc">$</span>depreciation <span class="sc">/</span> golf<span class="sc">$</span>new.price</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="co"># audi</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>audi <span class="ot">&lt;-</span> audi <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(new.price))</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>audi<span class="sc">$</span>depreciation <span class="ot">=</span> audi<span class="sc">$</span>new.price <span class="sc">-</span> audi<span class="sc">$</span>price</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>audi<span class="sc">$</span>rel_dep <span class="ot">=</span> audi<span class="sc">$</span>depreciation <span class="sc">/</span> audi<span class="sc">$</span>new.price</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="co"># skoda</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>skoda <span class="ot">&lt;-</span> skoda <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(new.price))</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>skoda<span class="sc">$</span>depreciation <span class="ot">=</span> skoda<span class="sc">$</span>new.price <span class="sc">-</span> skoda<span class="sc">$</span>price</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>skoda<span class="sc">$</span>rel_dep <span class="ot">=</span> skoda<span class="sc">$</span>depreciation <span class="sc">/</span> skoda<span class="sc">$</span>new.price</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="co">#remove NAs from skoda</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>skoda <span class="ot">&lt;-</span> skoda[<span class="sc">!</span><span class="fu">is.na</span>(skoda<span class="sc">$</span>vehicle.age),]</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="co"># volvo</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>volvo <span class="ot">&lt;-</span> volvo <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(new.price))</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>volvo<span class="sc">$</span>depreciation <span class="ot">=</span> volvo<span class="sc">$</span>new.price <span class="sc">-</span> volvo<span class="sc">$</span>price</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>volvo<span class="sc">$</span>rel_dep <span class="ot">=</span> volvo<span class="sc">$</span>depreciation <span class="sc">/</span> volvo<span class="sc">$</span>new.price</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a><span class="co"># toyota</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>toyota <span class="ot">&lt;-</span> toyota <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(new.price))</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>toyota<span class="sc">$</span>depreciation <span class="ot">=</span> toyota<span class="sc">$</span>new.price <span class="sc">-</span> toyota<span class="sc">$</span>price</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>toyota<span class="sc">$</span>rel_dep <span class="ot">=</span> toyota<span class="sc">$</span>depreciation <span class="sc">/</span> toyota<span class="sc">$</span>new.price</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Table for reductions in sample size continued</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>sample_sizes_2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>  <span class="st">"VW Golf"</span> <span class="ot">=</span> <span class="fu">nrow</span>(golf),</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Audi A3"</span> <span class="ot">=</span> <span class="fu">nrow</span>(audi),</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Skoda Octavia"</span> <span class="ot">=</span> <span class="fu">nrow</span>(skoda),</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Volvo XC60"</span> <span class="ot">=</span> <span class="fu">nrow</span>(volvo),</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Toyota Yaris"</span> <span class="ot">=</span> <span class="fu">nrow</span>(toyota)</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>sample_sizes_change <span class="ot">&lt;-</span> ((sample_sizes <span class="sc">-</span> sample_sizes_2) <span class="sc">/</span> sample_sizes) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>sample_sizes <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sample_sizes, sample_sizes_2)</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>sample_sizes <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sample_sizes, sample_sizes_change)</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>sample_sizes <span class="ot">&lt;-</span> <span class="fu">round</span>(sample_sizes, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>sample_sizes[<span class="dv">3</span>,] <span class="ot">&lt;-</span> <span class="fu">paste</span>(sample_sizes[<span class="dv">3</span>,], <span class="st">"%"</span>, <span class="at">sep =</span> <span class="st">" "</span>)</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(sample_sizes) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Original"</span>, <span class="st">"Filtered"</span>, <span class="st">"Reduction"</span>)</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>sample_sizes <span class="sc">|&gt;</span></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">|&gt;</span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th">VW.Golf</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Audi.A3</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Skoda.Octavia</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Volvo.XC60</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Toyota.Yaris</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Original</td>
<td style="text-align: left;">3261</td>
<td style="text-align: left;">1016</td>
<td style="text-align: left;">1877</td>
<td style="text-align: left;">913</td>
<td style="text-align: left;">486</td>
</tr>
<tr class="even">
<td style="text-align: left;">Filtered</td>
<td style="text-align: left;">791</td>
<td style="text-align: left;">322</td>
<td style="text-align: left;">536</td>
<td style="text-align: left;">506</td>
<td style="text-align: left;">79</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Reduction</td>
<td style="text-align: left;">76 %</td>
<td style="text-align: left;">68 %</td>
<td style="text-align: left;">71 %</td>
<td style="text-align: left;">45 %</td>
<td style="text-align: left;">84 %</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="new-prices-vs-listing-prices" class="level4">
<h4 class="anchored" data-anchor-id="new-prices-vs-listing-prices">2.3.2 New prices vs listing prices</h4>
<p>These plots show the new prices of cars compared with their actual prices, sorted by the new price.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>a1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(golf[<span class="fu">order</span>(golf<span class="sc">$</span>new.price),]) <span class="sc">+</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(new.price), <span class="at">y =</span> new.price), <span class="at">color =</span> <span class="st">"royalblue"</span>) <span class="sc">+</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="fu">max</span>(golf<span class="sc">$</span>new.price)) <span class="sc">+</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(golf)) <span class="sc">+</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(new.price), <span class="at">y =</span> price), <span class="at">color =</span> <span class="st">"orangered"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(new.price),</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymin =</span> <span class="fu">predict</span>(<span class="fu">loess</span>(price <span class="sc">~</span> <span class="fu">seq</span>(price), <span class="at">span =</span> <span class="fl">0.1</span>)),</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymax =</span> <span class="fu">predict</span>(<span class="fu">loess</span>(new.price <span class="sc">~</span> <span class="fu">seq</span>(price), <span class="at">span =</span> <span class="fl">0.1</span>))),</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">"grey"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Observations sorted by new price"</span>, <span class="at">y =</span> <span class="st">"Price"</span>, <span class="at">title =</span> <span class="st">"Comparison of listing prices and new prices"</span>, <span class="at">subtitle =</span> <span class="st">"&lt;span style='color:royalblue;'&gt;&amp;#9899; New prices&lt;/span&gt;&lt;br/&gt;&lt;span style='color:orangered;'&gt;&amp;#9899; Actual prices&lt;/span&gt;"</span>) <span class="sc">+</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"VW Golf"</span>) <span class="sc">+</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_markdown</span>())</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co"># New prices vs listing prices audi</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>a2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(audi[<span class="fu">order</span>(audi<span class="sc">$</span>new.price),]) <span class="sc">+</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(new.price), <span class="at">y =</span> new.price), <span class="at">color =</span> <span class="st">"royalblue"</span>) <span class="sc">+</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="fu">max</span>(audi<span class="sc">$</span>new.price)) <span class="sc">+</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(audi)) <span class="sc">+</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(new.price), <span class="at">y =</span> price), <span class="at">color =</span> <span class="st">"orangered"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(new.price),</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymin =</span> <span class="fu">predict</span>(<span class="fu">loess</span>(price <span class="sc">~</span> <span class="fu">seq</span>(price), <span class="at">span =</span> <span class="fl">0.1</span>)),</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymax =</span> <span class="fu">predict</span>(<span class="fu">loess</span>(new.price <span class="sc">~</span> <span class="fu">seq</span>(price), <span class="at">span =</span> <span class="fl">0.1</span>))),</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">"grey"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Observations sorted by new price"</span>, <span class="at">y =</span> <span class="st">"Price"</span>, <span class="at">title =</span> <span class="st">"Comparison of listing prices and new prices"</span>, <span class="at">subtitle =</span> <span class="st">"&lt;span style='color:royalblue;'&gt;&amp;#9899; New prices&lt;/span&gt;&lt;br/&gt;&lt;span style='color:orangered;'&gt;&amp;#9899; Actual prices&lt;/span&gt;"</span>) <span class="sc">+</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Audi A3"</span>) <span class="sc">+</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_markdown</span>())</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="co"># New prices vs listing prices skoda</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>a3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(skoda[<span class="fu">order</span>(skoda<span class="sc">$</span>new.price),]) <span class="sc">+</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(new.price), <span class="at">y =</span> new.price), <span class="at">color =</span> <span class="st">"royalblue"</span>) <span class="sc">+</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="fu">max</span>(skoda<span class="sc">$</span>new.price)) <span class="sc">+</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(skoda)) <span class="sc">+</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(new.price), <span class="at">y =</span> price), <span class="at">color =</span> <span class="st">"orangered"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(new.price),</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymin =</span> <span class="fu">predict</span>(<span class="fu">loess</span>(price <span class="sc">~</span> <span class="fu">seq</span>(price), <span class="at">span =</span> <span class="fl">0.1</span>)),</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymax =</span> <span class="fu">predict</span>(<span class="fu">loess</span>(new.price <span class="sc">~</span> <span class="fu">seq</span>(price), <span class="at">span =</span> <span class="fl">0.1</span>))),</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">"grey"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Observations sorted by new price"</span>, <span class="at">y =</span> <span class="st">"Price"</span>, <span class="at">title =</span> <span class="st">"Comparison of listing prices and new prices"</span>, <span class="at">subtitle =</span> <span class="st">"&lt;span style='color:royalblue;'&gt;&amp;#9899; New prices&lt;/span&gt;&lt;br/&gt;&lt;span style='color:orangered;'&gt;&amp;#9899; Actual prices&lt;/span&gt;"</span>) <span class="sc">+</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Skoda Octavia"</span>) <span class="sc">+</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_markdown</span>())</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a><span class="co"># New prices vs listing prices volvo</span></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>a4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(volvo[<span class="fu">order</span>(volvo<span class="sc">$</span>new.price),]) <span class="sc">+</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(new.price), <span class="at">y =</span> new.price), <span class="at">color =</span> <span class="st">"royalblue"</span>) <span class="sc">+</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="fu">max</span>(volvo<span class="sc">$</span>new.price)) <span class="sc">+</span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(volvo)) <span class="sc">+</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(new.price), <span class="at">y =</span> price), <span class="at">color =</span> <span class="st">"orangered"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(new.price),</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymin =</span> <span class="fu">predict</span>(<span class="fu">loess</span>(price <span class="sc">~</span> <span class="fu">seq</span>(price), <span class="at">span =</span> <span class="fl">0.1</span>)),</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymax =</span> <span class="fu">predict</span>(<span class="fu">loess</span>(new.price <span class="sc">~</span> <span class="fu">seq</span>(price), <span class="at">span =</span> <span class="fl">0.1</span>))),</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">"grey"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Observations sorted by new price"</span>, <span class="at">y =</span> <span class="st">"Price"</span>, <span class="at">title =</span> <span class="st">"Comparison of listing prices and new prices"</span>, <span class="at">subtitle =</span> <span class="st">"&lt;span style='color:royalblue;'&gt;&amp;#9899; New prices&lt;/span&gt;&lt;br/&gt;&lt;span style='color:orangered;'&gt;&amp;#9899; Actual prices&lt;/span&gt;"</span>) <span class="sc">+</span></span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Volvo XC60"</span>) <span class="sc">+</span></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_markdown</span>())</span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a><span class="co"># New prices vs listing prices toyota</span></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>a5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(toyota[<span class="fu">order</span>(toyota<span class="sc">$</span>new.price),]) <span class="sc">+</span></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(new.price), <span class="at">y =</span> new.price), <span class="at">color =</span> <span class="st">"royalblue"</span>) <span class="sc">+</span></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="fu">max</span>(toyota<span class="sc">$</span>new.price)) <span class="sc">+</span></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(toyota)) <span class="sc">+</span></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(new.price), <span class="at">y =</span> price), <span class="at">color =</span> <span class="st">"orangered"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(new.price),</span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymin =</span> <span class="fu">predict</span>(<span class="fu">loess</span>(price <span class="sc">~</span> <span class="fu">seq</span>(price), <span class="at">span =</span> <span class="fl">0.1</span>)),</span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymax =</span> <span class="fu">predict</span>(<span class="fu">loess</span>(new.price <span class="sc">~</span> <span class="fu">seq</span>(price), <span class="at">span =</span> <span class="fl">0.1</span>))),</span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">"grey"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Observations sorted by new price"</span>, <span class="at">y =</span> <span class="st">"Price"</span>, <span class="at">title =</span> <span class="st">"Comparison of listing prices and new prices"</span>, <span class="at">subtitle =</span> <span class="st">"&lt;span style='color:royalblue;'&gt;&amp;#9899; New prices&lt;/span&gt;&lt;br/&gt;&lt;span style='color:orangered;'&gt;&amp;#9899; Actual prices&lt;/span&gt;"</span>) <span class="sc">+</span></span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Toyota Yaris"</span>) <span class="sc">+</span></span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_markdown</span>())</span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a><span class="co"># Patchwork</span></span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a><span class="co">#a1</span></span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a><span class="co">#(a2 | a3) /</span></span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a><span class="co">#(a4 | a5)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">VW Golf</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Audi A3</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href="">Skoda Octavia</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false" href="">Volvo XC60</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false" href="">Toyota Yaris</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>a1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_Q3_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>a2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_Q3_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>a3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_Q3_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>a4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_Q3_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>a5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_Q3_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>It seems the new and actual prices are strongly related.</p>
</section>
<section id="new-prices-vs-depreciation" class="level4">
<h4 class="anchored" data-anchor-id="new-prices-vs-depreciation">2.3.3 New prices vs depreciation</h4>
<p>We now look at the new prices of vehicles compared to their relative depreciation. The relative depreciation is defined as (new price - actual price) / new price</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># New prices vs depreciation golf</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(golf[<span class="fu">order</span>(golf<span class="sc">$</span>new.price),]) <span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(new.price), <span class="at">y =</span> new.price), <span class="at">color =</span> <span class="st">"royalblue"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">100000</span>) <span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(golf)) <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(new.price), <span class="at">y =</span> rel_dep<span class="sc">*</span><span class="dv">100000</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">stroke =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(new.price), <span class="at">y =</span> rel_dep<span class="sc">*</span><span class="dv">100000</span>), <span class="at">color =</span> <span class="st">"orangered"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Observations sorted by new price"</span>, <span class="at">y =</span> <span class="st">"Price"</span>, <span class="at">title =</span> <span class="st">"Comparison of new prices and relative depreciation"</span>, <span class="at">subtitle =</span> <span class="st">"&lt;span style='color:royalblue;'&gt;&amp;#9899; New prices&lt;/span&gt;&lt;br/&gt;&lt;span style='color:orangered;'&gt;&amp;#9899; Relative depreciation&lt;/span&gt;"</span>) <span class="sc">+</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">/</span><span class="dv">100000</span>, <span class="at">name =</span> <span class="st">"Relative depreciation"</span>)) <span class="sc">+</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_markdown</span>())</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co"># New prices vs depreciation audi</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(audi[<span class="fu">order</span>(audi<span class="sc">$</span>new.price),]) <span class="sc">+</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(new.price), <span class="at">y =</span> new.price), <span class="at">color =</span> <span class="st">"royalblue"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">100000</span>) <span class="sc">+</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(audi)) <span class="sc">+</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(new.price), <span class="at">y =</span> rel_dep<span class="sc">*</span><span class="dv">100000</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">stroke =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(new.price), <span class="at">y =</span> rel_dep<span class="sc">*</span><span class="dv">100000</span>), <span class="at">color =</span> <span class="st">"orangered"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Observations sorted by new price"</span>, <span class="at">y =</span> <span class="st">"Price"</span>, <span class="at">title =</span> <span class="st">"Comparison of new prices and relative depreciation"</span>, <span class="at">subtitle =</span> <span class="st">"&lt;span style='color:royalblue;'&gt;&amp;#9899; New prices&lt;/span&gt;&lt;br/&gt;&lt;span style='color:orangered;'&gt;&amp;#9899; Relative depreciation&lt;/span&gt;"</span>) <span class="sc">+</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">/</span><span class="dv">100000</span>, <span class="at">name =</span> <span class="st">"Relative depreciation"</span>)) <span class="sc">+</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_markdown</span>())</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="co"># New prices vs depreciation skoda</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(skoda[<span class="fu">order</span>(skoda<span class="sc">$</span>new.price),]) <span class="sc">+</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(new.price), <span class="at">y =</span> new.price), <span class="at">color =</span> <span class="st">"royalblue"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">100000</span>) <span class="sc">+</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(skoda)) <span class="sc">+</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(new.price), <span class="at">y =</span> rel_dep<span class="sc">*</span><span class="dv">100000</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">stroke =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(new.price), <span class="at">y =</span> rel_dep<span class="sc">*</span><span class="dv">100000</span>), <span class="at">color =</span> <span class="st">"orangered"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Observations sorted by new price"</span>, <span class="at">y =</span> <span class="st">"Price"</span>, <span class="at">title =</span> <span class="st">"Comparison of new prices and relative depreciation"</span>, <span class="at">subtitle =</span> <span class="st">"&lt;span style='color:royalblue;'&gt;&amp;#9899; New prices&lt;/span&gt;&lt;br/&gt;&lt;span style='color:orangered;'&gt;&amp;#9899; Relative depreciation&lt;/span&gt;"</span>) <span class="sc">+</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">/</span><span class="dv">100000</span>, <span class="at">name =</span> <span class="st">"Relative depreciation"</span>)) <span class="sc">+</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_markdown</span>())</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a><span class="co"># New prices vs depreciation volvo</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>b4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(volvo[<span class="fu">order</span>(volvo<span class="sc">$</span>new.price),]) <span class="sc">+</span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(new.price), <span class="at">y =</span> new.price), <span class="at">color =</span> <span class="st">"royalblue"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">100000</span>) <span class="sc">+</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(volvo)) <span class="sc">+</span></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(new.price), <span class="at">y =</span> rel_dep<span class="sc">*</span><span class="dv">100000</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">stroke =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(new.price), <span class="at">y =</span> rel_dep<span class="sc">*</span><span class="dv">100000</span>), <span class="at">color =</span> <span class="st">"orangered"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Observations sorted by new price"</span>, <span class="at">y =</span> <span class="st">"Price"</span>, <span class="at">title =</span> <span class="st">"Comparison of new prices and relative depreciation"</span>, <span class="at">subtitle =</span> <span class="st">"&lt;span style='color:royalblue;'&gt;&amp;#9899; New prices&lt;/span&gt;&lt;br/&gt;&lt;span style='color:orangered;'&gt;&amp;#9899; Relative depreciation&lt;/span&gt;"</span>) <span class="sc">+</span></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">/</span><span class="dv">100000</span>, <span class="at">name =</span> <span class="st">"Relative depreciation"</span>)) <span class="sc">+</span></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_markdown</span>())</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a><span class="co"># New prices vs depreciation toyota</span></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>b5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(toyota[<span class="fu">order</span>(toyota<span class="sc">$</span>new.price),]) <span class="sc">+</span></span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(new.price), <span class="at">y =</span> new.price), <span class="at">color =</span> <span class="st">"royalblue"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">100000</span>) <span class="sc">+</span></span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(toyota)) <span class="sc">+</span></span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(new.price), <span class="at">y =</span> rel_dep<span class="sc">*</span><span class="dv">100000</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">stroke =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(new.price), <span class="at">y =</span> rel_dep<span class="sc">*</span><span class="dv">100000</span>), <span class="at">color =</span> <span class="st">"orangered"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Observations sorted by new price"</span>, <span class="at">y =</span> <span class="st">"Price"</span>, <span class="at">title =</span> <span class="st">"Comparison of new prices and relative depreciation"</span>, <span class="at">subtitle =</span> <span class="st">"&lt;span style='color:royalblue;'&gt;&amp;#9899; New prices&lt;/span&gt;&lt;br/&gt;&lt;span style='color:orangered;'&gt;&amp;#9899; Relative depreciation&lt;/span&gt;"</span>) <span class="sc">+</span></span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">/</span><span class="dv">100000</span>, <span class="at">name =</span> <span class="st">"Relative depreciation"</span>)) <span class="sc">+</span></span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_markdown</span>())</span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Patchwork</span></span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a><span class="co">#b1 +</span></span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a> <span class="co"># plot_annotation(title = "Comparison of new prices and relative depreciation")</span></span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a><span class="co">#b2</span></span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a><span class="co">#b3</span></span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a><span class="co">#b4</span></span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a><span class="co">#b5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href="">VW Golf</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false" href="">Audi A3</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false" href="">Skoda Octavia</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false" href="">Volvo XC60</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-5" role="tab" aria-controls="tabset-2-5" aria-selected="false" href="">Toyota Yaris</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>b1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_Q3_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>b2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_Q3_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>b3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_Q3_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>b4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_Q3_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-5-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>b5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_Q3_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>We can see that these are weakly negatively correlated, but it does not stand out in the graphs.</p>
</section>
<section id="current-prices-vs-depreciation" class="level4">
<h4 class="anchored" data-anchor-id="current-prices-vs-depreciation">2.3.4 Current prices vs depreciation</h4>
<p>We will now compare current vehicle prices and their relative depreciation</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prices vs depreciation golf</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>c1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(golf[<span class="fu">order</span>(golf<span class="sc">$</span>price),]) <span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(price), <span class="at">y =</span> price), <span class="at">color =</span> <span class="st">"royalblue"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">100000</span>) <span class="sc">+</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(golf)) <span class="sc">+</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(price), <span class="at">y =</span> rel_dep<span class="sc">*</span><span class="dv">100000</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">stroke =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(price), <span class="at">y =</span> rel_dep<span class="sc">*</span><span class="dv">100000</span>), <span class="at">color =</span> <span class="st">"orangered"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Observations sorted by price"</span>, <span class="at">y =</span> <span class="st">"Price"</span>, <span class="at">title =</span> <span class="st">"Comparison of prices and relative depreciation"</span>, <span class="at">subtitle =</span> <span class="st">"&lt;span style='color:royalblue;'&gt;&amp;#9899; Prices&lt;/span&gt;&lt;br/&gt;&lt;span style='color:orangered;'&gt;&amp;#9899; Relative depreciation&lt;/span&gt;"</span>) <span class="sc">+</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">/</span><span class="dv">100000</span>, <span class="at">name =</span> <span class="st">"Relative depreciation"</span>)) <span class="sc">+</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_markdown</span>())</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Prices vs depreciation audi</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>c2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(audi[<span class="fu">order</span>(audi<span class="sc">$</span>price),]) <span class="sc">+</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(price), <span class="at">y =</span> price), <span class="at">color =</span> <span class="st">"royalblue"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">100000</span>) <span class="sc">+</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(audi)) <span class="sc">+</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(price), <span class="at">y =</span> rel_dep<span class="sc">*</span><span class="dv">100000</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">stroke =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(price), <span class="at">y =</span> rel_dep<span class="sc">*</span><span class="dv">100000</span>), <span class="at">color =</span> <span class="st">"orangered"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Observations sorted by price"</span>, <span class="at">y =</span> <span class="st">"Price"</span>, <span class="at">title =</span> <span class="st">"Comparison of prices and relative depreciation"</span>, <span class="at">subtitle =</span> <span class="st">"&lt;span style='color:royalblue;'&gt;&amp;#9899; Prices&lt;/span&gt;&lt;br/&gt;&lt;span style='color:orangered;'&gt;&amp;#9899; Relative depreciation&lt;/span&gt;"</span>) <span class="sc">+</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">/</span><span class="dv">100000</span>, <span class="at">name =</span> <span class="st">"Relative depreciation"</span>)) <span class="sc">+</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_markdown</span>())</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Prices vs depreciation skoda</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>c3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(skoda[<span class="fu">order</span>(skoda<span class="sc">$</span>price),]) <span class="sc">+</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(price), <span class="at">y =</span> price), <span class="at">color =</span> <span class="st">"royalblue"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">100000</span>) <span class="sc">+</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(skoda)) <span class="sc">+</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(price), <span class="at">y =</span> rel_dep<span class="sc">*</span><span class="dv">100000</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">stroke =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(price), <span class="at">y =</span> rel_dep<span class="sc">*</span><span class="dv">100000</span>), <span class="at">color =</span> <span class="st">"orangered"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Observations sorted by price"</span>, <span class="at">y =</span> <span class="st">"Price"</span>, <span class="at">title =</span> <span class="st">"Comparison of prices and relative depreciation"</span>, <span class="at">subtitle =</span> <span class="st">"&lt;span style='color:royalblue;'&gt;&amp;#9899; Prices&lt;/span&gt;&lt;br/&gt;&lt;span style='color:orangered;'&gt;&amp;#9899; Relative depreciation&lt;/span&gt;"</span>) <span class="sc">+</span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">/</span><span class="dv">100000</span>, <span class="at">name =</span> <span class="st">"Relative depreciation"</span>)) <span class="sc">+</span></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_markdown</span>())</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Prices vs depreciation volvo</span></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>c4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(volvo[<span class="fu">order</span>(volvo<span class="sc">$</span>price),]) <span class="sc">+</span></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(price), <span class="at">y =</span> price), <span class="at">color =</span> <span class="st">"royalblue"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">100000</span>) <span class="sc">+</span></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(volvo)) <span class="sc">+</span></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(price), <span class="at">y =</span> rel_dep<span class="sc">*</span><span class="dv">100000</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">stroke =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(price), <span class="at">y =</span> rel_dep<span class="sc">*</span><span class="dv">100000</span>), <span class="at">color =</span> <span class="st">"orangered"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Observations sorted by price"</span>, <span class="at">y =</span> <span class="st">"Price"</span>, <span class="at">title =</span> <span class="st">"Comparison of prices and relative depreciation"</span>, <span class="at">subtitle =</span> <span class="st">"&lt;span style='color:royalblue;'&gt;&amp;#9899; Prices&lt;/span&gt;&lt;br/&gt;&lt;span style='color:orangered;'&gt;&amp;#9899; Relative depreciation&lt;/span&gt;"</span>) <span class="sc">+</span></span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">/</span><span class="dv">100000</span>, <span class="at">name =</span> <span class="st">"Relative depreciation"</span>)) <span class="sc">+</span></span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_markdown</span>())</span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Prices vs depreciation toyota</span></span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a>c5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(toyota[<span class="fu">order</span>(toyota<span class="sc">$</span>price),]) <span class="sc">+</span></span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(price), <span class="at">y =</span> price), <span class="at">color =</span> <span class="st">"royalblue"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">100000</span>) <span class="sc">+</span></span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(toyota)) <span class="sc">+</span></span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(price), <span class="at">y =</span> rel_dep<span class="sc">*</span><span class="dv">100000</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">stroke =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(price), <span class="at">y =</span> rel_dep<span class="sc">*</span><span class="dv">100000</span>), <span class="at">color =</span> <span class="st">"orangered"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Observations sorted by price"</span>, <span class="at">y =</span> <span class="st">"Price"</span>, <span class="at">title =</span> <span class="st">"Comparison of prices and relative depreciation"</span>, <span class="at">subtitle =</span> <span class="st">"&lt;span style='color:royalblue;'&gt;&amp;#9899; Prices&lt;/span&gt;&lt;br/&gt;&lt;span style='color:orangered;'&gt;&amp;#9899; Relative depreciation&lt;/span&gt;"</span>) <span class="sc">+</span></span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">/</span><span class="dv">100000</span>, <span class="at">name =</span> <span class="st">"Relative depreciation"</span>)) <span class="sc">+</span></span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_markdown</span>())</span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-66"><a href="#cb14-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Patchwork</span></span>
<span id="cb14-67"><a href="#cb14-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-68"><a href="#cb14-68" aria-hidden="true" tabindex="-1"></a><span class="co">#c1 +</span></span>
<span id="cb14-69"><a href="#cb14-69" aria-hidden="true" tabindex="-1"></a><span class="co">#  plot_annotation(title = "Comparison of current prices and relative depreciation")</span></span>
<span id="cb14-70"><a href="#cb14-70" aria-hidden="true" tabindex="-1"></a><span class="co">#c2</span></span>
<span id="cb14-71"><a href="#cb14-71" aria-hidden="true" tabindex="-1"></a><span class="co">#c3</span></span>
<span id="cb14-72"><a href="#cb14-72" aria-hidden="true" tabindex="-1"></a><span class="co">#c4</span></span>
<span id="cb14-73"><a href="#cb14-73" aria-hidden="true" tabindex="-1"></a><span class="co">#c5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true" href="">VW Golf</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false" href="">Audi A3</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false" href="">Skoda Octavia</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false" href="">Volvo XC60</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-5" role="tab" aria-controls="tabset-3-5" aria-selected="false" href="">Toyota Yaris</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>c1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_Q3_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>c2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_Q3_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>c3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_Q3_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>c4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_Q3_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-3-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-5-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>c5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_Q3_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>Current vehicle prices are obviously negatively correlated with relative depreciation, which makes sense.</p>
</section>
<section id="vehicle-age-vs-depreciation" class="level4">
<h4 class="anchored" data-anchor-id="vehicle-age-vs-depreciation">2.3.5 Vehicle age vs depreciation</h4>
<p>Vehicle age is probably the biggest influencing factor that defines the definition of depreciation, so we can see in the graphs that it is strongly related to relative depreciation.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vehicle age vs depreciation golf</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(golf[<span class="fu">order</span>(golf<span class="sc">$</span>vehicle.age),]) <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(vehicle.age), <span class="at">y =</span> vehicle.age<span class="sc">/</span><span class="dv">365</span>), <span class="at">color =</span> <span class="st">"royalblue"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="fu">max</span>(golf<span class="sc">$</span>vehicle.age)<span class="sc">/</span><span class="dv">365</span>) <span class="sc">+</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(golf)) <span class="sc">+</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(vehicle.age), <span class="at">y =</span> rel_dep<span class="sc">*</span>(<span class="fu">max</span>(golf<span class="sc">$</span>vehicle.age)<span class="sc">/</span><span class="dv">365</span>)), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">stroke =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(price), <span class="at">y =</span> rel_dep<span class="sc">*</span>(<span class="fu">max</span>(golf<span class="sc">$</span>vehicle.age)<span class="sc">/</span><span class="dv">365</span>)), <span class="at">color =</span> <span class="st">"orangered"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Observations sorted by vehicle age"</span>, <span class="at">y =</span> <span class="st">"Vehicle age (years)"</span>, <span class="at">title =</span> <span class="st">"Comparison of vehicle age and relative depreciation"</span>, <span class="at">subtitle =</span> <span class="st">"&lt;span style='color:royalblue;'&gt;&amp;#9899; Vehicle age (years)&lt;/span&gt;&lt;br/&gt;&lt;span style='color:orangered;'&gt;&amp;#9899; Relative depreciation&lt;/span&gt;"</span>) <span class="sc">+</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">/</span>(<span class="fu">max</span>(golf<span class="sc">$</span>vehicle.age)<span class="sc">/</span><span class="dv">365</span>), <span class="at">name =</span> <span class="st">"Relative depreciation"</span>)) <span class="sc">+</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_markdown</span>())</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Vehicle age vs depreciation audi</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(audi[<span class="fu">order</span>(audi<span class="sc">$</span>vehicle.age),]) <span class="sc">+</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(vehicle.age), <span class="at">y =</span> vehicle.age<span class="sc">/</span><span class="dv">365</span>), <span class="at">color =</span> <span class="st">"royalblue"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="fu">max</span>(audi<span class="sc">$</span>vehicle.age)<span class="sc">/</span><span class="dv">365</span>) <span class="sc">+</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(audi)) <span class="sc">+</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(vehicle.age), <span class="at">y =</span> rel_dep<span class="sc">*</span>(<span class="fu">max</span>(audi<span class="sc">$</span>vehicle.age)<span class="sc">/</span><span class="dv">365</span>)), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">stroke =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(price), <span class="at">y =</span> rel_dep<span class="sc">*</span>(<span class="fu">max</span>(audi<span class="sc">$</span>vehicle.age)<span class="sc">/</span><span class="dv">365</span>)), <span class="at">color =</span> <span class="st">"orangered"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Observations sorted by vehicle age"</span>, <span class="at">y =</span> <span class="st">"Vehicle age (years)"</span>, <span class="at">title =</span> <span class="st">"Comparison of vehicle age and relative depreciation"</span>, <span class="at">subtitle =</span> <span class="st">"&lt;span style='color:royalblue;'&gt;&amp;#9899; Vehicle age (years)&lt;/span&gt;&lt;br/&gt;&lt;span style='color:orangered;'&gt;&amp;#9899; Relative depreciation&lt;/span&gt;"</span>) <span class="sc">+</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">/</span>(<span class="fu">max</span>(audi<span class="sc">$</span>vehicle.age)<span class="sc">/</span><span class="dv">365</span>), <span class="at">name =</span> <span class="st">"Relative depreciation"</span>)) <span class="sc">+</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_markdown</span>())</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Vehicle age vs depreciation skoda</span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>d3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(skoda[<span class="fu">order</span>(skoda<span class="sc">$</span>vehicle.age),]) <span class="sc">+</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(vehicle.age), <span class="at">y =</span> vehicle.age<span class="sc">/</span><span class="dv">365</span>), <span class="at">color =</span> <span class="st">"royalblue"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="fu">max</span>(skoda<span class="sc">$</span>vehicle.age)<span class="sc">/</span><span class="dv">365</span>) <span class="sc">+</span></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(skoda)) <span class="sc">+</span></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(vehicle.age), <span class="at">y =</span> rel_dep<span class="sc">*</span>(<span class="fu">max</span>(skoda<span class="sc">$</span>vehicle.age)<span class="sc">/</span><span class="dv">365</span>)), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">stroke =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(price), <span class="at">y =</span> rel_dep<span class="sc">*</span>(<span class="fu">max</span>(skoda<span class="sc">$</span>vehicle.age)<span class="sc">/</span><span class="dv">365</span>)), <span class="at">color =</span> <span class="st">"orangered"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Observations sorted by vehicle age"</span>, <span class="at">y =</span> <span class="st">"Vehicle age (years)"</span>, <span class="at">title =</span> <span class="st">"Comparison of vehicle age and relative depreciation"</span>, <span class="at">subtitle =</span> <span class="st">"&lt;span style='color:royalblue;'&gt;&amp;#9899; Vehicle age (years)&lt;/span&gt;&lt;br/&gt;&lt;span style='color:orangered;'&gt;&amp;#9899; Relative depreciation&lt;/span&gt;"</span>) <span class="sc">+</span></span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">/</span>(<span class="fu">max</span>(skoda<span class="sc">$</span>vehicle.age)<span class="sc">/</span><span class="dv">365</span>), <span class="at">name =</span> <span class="st">"Relative depreciation"</span>)) <span class="sc">+</span></span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_markdown</span>())</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Vehicle age vs depreciation volvo</span></span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>d4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(volvo[<span class="fu">order</span>(volvo<span class="sc">$</span>vehicle.age),]) <span class="sc">+</span></span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(vehicle.age), <span class="at">y =</span> vehicle.age<span class="sc">/</span><span class="dv">365</span>), <span class="at">color =</span> <span class="st">"royalblue"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="fu">max</span>(volvo<span class="sc">$</span>vehicle.age)<span class="sc">/</span><span class="dv">365</span>) <span class="sc">+</span></span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(volvo)) <span class="sc">+</span></span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(vehicle.age), <span class="at">y =</span> rel_dep<span class="sc">*</span>(<span class="fu">max</span>(volvo<span class="sc">$</span>vehicle.age)<span class="sc">/</span><span class="dv">365</span>)), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">stroke =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(price), <span class="at">y =</span> rel_dep<span class="sc">*</span>(<span class="fu">max</span>(volvo<span class="sc">$</span>vehicle.age)<span class="sc">/</span><span class="dv">365</span>)), <span class="at">color =</span> <span class="st">"orangered"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Observations sorted by vehicle age"</span>, <span class="at">y =</span> <span class="st">"Vehicle age (years)"</span>, <span class="at">title =</span> <span class="st">"Comparison of vehicle age and relative depreciation"</span>, <span class="at">subtitle =</span> <span class="st">"&lt;span style='color:royalblue;'&gt;&amp;#9899; Vehicle age (years)&lt;/span&gt;&lt;br/&gt;&lt;span style='color:orangered;'&gt;&amp;#9899; Relative depreciation&lt;/span&gt;"</span>) <span class="sc">+</span></span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">/</span>(<span class="fu">max</span>(volvo<span class="sc">$</span>vehicle.age)<span class="sc">/</span><span class="dv">365</span>), <span class="at">name =</span> <span class="st">"Relative depreciation"</span>)) <span class="sc">+</span></span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_markdown</span>())</span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Vehicle age vs depreciation toyota</span></span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a>d5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(toyota[<span class="fu">order</span>(toyota<span class="sc">$</span>vehicle.age),]) <span class="sc">+</span></span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(vehicle.age), <span class="at">y =</span> vehicle.age<span class="sc">/</span><span class="dv">365</span>), <span class="at">color =</span> <span class="st">"royalblue"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="fu">max</span>(toyota<span class="sc">$</span>vehicle.age)<span class="sc">/</span><span class="dv">365</span>) <span class="sc">+</span></span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(toyota)) <span class="sc">+</span></span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(vehicle.age), <span class="at">y =</span> rel_dep<span class="sc">*</span>(<span class="fu">max</span>(toyota<span class="sc">$</span>vehicle.age)<span class="sc">/</span><span class="dv">365</span>)), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">stroke =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb20-60"><a href="#cb20-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(price), <span class="at">y =</span> rel_dep<span class="sc">*</span>(<span class="fu">max</span>(toyota<span class="sc">$</span>vehicle.age)<span class="sc">/</span><span class="dv">365</span>)), <span class="at">color =</span> <span class="st">"orangered"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb20-61"><a href="#cb20-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Observations sorted by vehicle age"</span>, <span class="at">y =</span> <span class="st">"Vehicle age (years)"</span>, <span class="at">title =</span> <span class="st">"Comparison of vehicle age and relative depreciation"</span>, <span class="at">subtitle =</span> <span class="st">"&lt;span style='color:royalblue;'&gt;&amp;#9899; Vehicle age (years)&lt;/span&gt;&lt;br/&gt;&lt;span style='color:orangered;'&gt;&amp;#9899; Relative depreciation&lt;/span&gt;"</span>) <span class="sc">+</span></span>
<span id="cb20-62"><a href="#cb20-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">/</span>(<span class="fu">max</span>(toyota<span class="sc">$</span>vehicle.age)<span class="sc">/</span><span class="dv">365</span>), <span class="at">name =</span> <span class="st">"Relative depreciation"</span>)) <span class="sc">+</span></span>
<span id="cb20-63"><a href="#cb20-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb20-64"><a href="#cb20-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_markdown</span>())</span>
<span id="cb20-65"><a href="#cb20-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-66"><a href="#cb20-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Patchwork</span></span>
<span id="cb20-67"><a href="#cb20-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-68"><a href="#cb20-68" aria-hidden="true" tabindex="-1"></a><span class="co">#(d2 | d3) /</span></span>
<span id="cb20-69"><a href="#cb20-69" aria-hidden="true" tabindex="-1"></a> <span class="co"># (d4 | d5) +</span></span>
<span id="cb20-70"><a href="#cb20-70" aria-hidden="true" tabindex="-1"></a>  <span class="co">#plot_annotation(</span></span>
<span id="cb20-71"><a href="#cb20-71" aria-hidden="true" tabindex="-1"></a>   <span class="co"># title = "Comparison of vehicle age and relative depreciation"</span></span>
<span id="cb20-72"><a href="#cb20-72" aria-hidden="true" tabindex="-1"></a><span class="co">#  )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true" href="">VW Golf</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false" href="">Audi A3</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false" href="">Skoda Octavia</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false" href="">Volvo XC60</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-5" role="tab" aria-controls="tabset-4-5" aria-selected="false" href="">Toyota Yaris</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>d1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_Q3_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>d2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_Q3_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>d3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_Q3_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>d4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_Q3_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-4-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-5-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>d5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_Q3_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="kilometers-vs-depreciation" class="level4">
<h4 class="anchored" data-anchor-id="kilometers-vs-depreciation">2.3.6 Kilometers vs depreciation</h4>
<p>Kilometers is most likely the second biggest determinant of depreciation. Here are some graphs that put this into perspective.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Kilometers vs depreciation golf</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(golf[<span class="fu">order</span>(golf<span class="sc">$</span>kilometers),]) <span class="sc">+</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(kilometers), <span class="at">y =</span> kilometers), <span class="at">color =</span> <span class="st">"royalblue"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="fu">max</span>(golf<span class="sc">$</span>kilometers)) <span class="sc">+</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(golf)) <span class="sc">+</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(kilometers), <span class="at">y =</span> rel_dep<span class="sc">*</span><span class="fu">max</span>(golf<span class="sc">$</span>kilometers)), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">stroke =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(price), <span class="at">y =</span> rel_dep<span class="sc">*</span><span class="fu">max</span>(golf<span class="sc">$</span>kilometers)), <span class="at">color =</span> <span class="st">"orangered"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Observations sorted by kilometers"</span>, <span class="at">y =</span> <span class="st">"Kilometers"</span>, <span class="at">title =</span> <span class="st">"Comparison of kilometers and relative depreciation"</span>, <span class="at">subtitle =</span> <span class="st">"&lt;span style='color:royalblue;'&gt;&amp;#9899; Kilometers&lt;/span&gt;&lt;br/&gt;&lt;span style='color:orangered;'&gt;&amp;#9899; Relative depreciation&lt;/span&gt;"</span>) <span class="sc">+</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">/</span><span class="fu">max</span>(golf<span class="sc">$</span>kilometers), <span class="at">name =</span> <span class="st">"Relative depreciation"</span>)) <span class="sc">+</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_markdown</span>())</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Kilometers vs depreciation audi</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>e2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(audi[<span class="fu">order</span>(audi<span class="sc">$</span>kilometers),]) <span class="sc">+</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(kilometers), <span class="at">y =</span> kilometers), <span class="at">color =</span> <span class="st">"royalblue"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="fu">max</span>(audi<span class="sc">$</span>kilometers)) <span class="sc">+</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(audi)) <span class="sc">+</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(kilometers), <span class="at">y =</span> rel_dep<span class="sc">*</span><span class="fu">max</span>(audi<span class="sc">$</span>kilometers)), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">stroke =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(price), <span class="at">y =</span> rel_dep<span class="sc">*</span><span class="fu">max</span>(audi<span class="sc">$</span>kilometers)), <span class="at">color =</span> <span class="st">"orangered"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Observations sorted by kilometers"</span>, <span class="at">y =</span> <span class="st">"Kilometers"</span>, <span class="at">title =</span> <span class="st">"Comparison of kilometers and relative depreciation"</span>, <span class="at">subtitle =</span> <span class="st">"&lt;span style='color:royalblue;'&gt;&amp;#9899; Kilometers&lt;/span&gt;&lt;br/&gt;&lt;span style='color:orangered;'&gt;&amp;#9899; Relative depreciation&lt;/span&gt;"</span>) <span class="sc">+</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">/</span><span class="fu">max</span>(audi<span class="sc">$</span>kilometers), <span class="at">name =</span> <span class="st">"Relative depreciation"</span>)) <span class="sc">+</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_markdown</span>())</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Kilometers vs depreciation skoda</span></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>e3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(skoda[<span class="fu">order</span>(skoda<span class="sc">$</span>kilometers),]) <span class="sc">+</span></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(kilometers), <span class="at">y =</span> kilometers), <span class="at">color =</span> <span class="st">"royalblue"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="fu">max</span>(skoda<span class="sc">$</span>kilometers)) <span class="sc">+</span></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(skoda)) <span class="sc">+</span></span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(kilometers), <span class="at">y =</span> rel_dep<span class="sc">*</span><span class="fu">max</span>(skoda<span class="sc">$</span>kilometers)), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">stroke =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(price), <span class="at">y =</span> rel_dep<span class="sc">*</span><span class="fu">max</span>(skoda<span class="sc">$</span>kilometers)), <span class="at">color =</span> <span class="st">"orangered"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Observations sorted by kilometers"</span>, <span class="at">y =</span> <span class="st">"Kilometers"</span>, <span class="at">title =</span> <span class="st">"Comparison of kilometers and relative depreciation"</span>, <span class="at">subtitle =</span> <span class="st">"&lt;span style='color:royalblue;'&gt;&amp;#9899; Kilometers&lt;/span&gt;&lt;br/&gt;&lt;span style='color:orangered;'&gt;&amp;#9899; Relative depreciation&lt;/span&gt;"</span>) <span class="sc">+</span></span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">/</span><span class="fu">max</span>(skoda<span class="sc">$</span>kilometers), <span class="at">name =</span> <span class="st">"Relative depreciation"</span>)) <span class="sc">+</span></span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_markdown</span>())</span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Kilometers vs depreciation volvo</span></span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>e4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(volvo[<span class="fu">order</span>(volvo<span class="sc">$</span>kilometers),]) <span class="sc">+</span></span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(kilometers), <span class="at">y =</span> kilometers), <span class="at">color =</span> <span class="st">"royalblue"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="fu">max</span>(volvo<span class="sc">$</span>kilometers)) <span class="sc">+</span></span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(volvo)) <span class="sc">+</span></span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(kilometers), <span class="at">y =</span> rel_dep<span class="sc">*</span><span class="fu">max</span>(volvo<span class="sc">$</span>kilometers)), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">stroke =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(price), <span class="at">y =</span> rel_dep<span class="sc">*</span><span class="fu">max</span>(volvo<span class="sc">$</span>kilometers)), <span class="at">color =</span> <span class="st">"orangered"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Observations sorted by kilometers"</span>, <span class="at">y =</span> <span class="st">"Kilometers"</span>, <span class="at">title =</span> <span class="st">"Comparison of kilometers and relative depreciation"</span>, <span class="at">subtitle =</span> <span class="st">"&lt;span style='color:royalblue;'&gt;&amp;#9899; Kilometers&lt;/span&gt;&lt;br/&gt;&lt;span style='color:orangered;'&gt;&amp;#9899; Relative depreciation&lt;/span&gt;"</span>) <span class="sc">+</span></span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">/</span><span class="fu">max</span>(volvo<span class="sc">$</span>kilometers), <span class="at">name =</span> <span class="st">"Relative depreciation"</span>)) <span class="sc">+</span></span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_markdown</span>())</span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Kilometers vs depreciation toyota</span></span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a>e5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(toyota[<span class="fu">order</span>(toyota<span class="sc">$</span>kilometers),]) <span class="sc">+</span></span>
<span id="cb26-56"><a href="#cb26-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(kilometers), <span class="at">y =</span> kilometers), <span class="at">color =</span> <span class="st">"royalblue"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb26-57"><a href="#cb26-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="fu">max</span>(toyota<span class="sc">$</span>kilometers)) <span class="sc">+</span></span>
<span id="cb26-58"><a href="#cb26-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(toyota)) <span class="sc">+</span></span>
<span id="cb26-59"><a href="#cb26-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(kilometers), <span class="at">y =</span> rel_dep<span class="sc">*</span><span class="fu">max</span>(toyota<span class="sc">$</span>kilometers)), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">stroke =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb26-60"><a href="#cb26-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(price), <span class="at">y =</span> rel_dep<span class="sc">*</span><span class="fu">max</span>(toyota<span class="sc">$</span>kilometers)), <span class="at">color =</span> <span class="st">"orangered"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb26-61"><a href="#cb26-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Observations sorted by kilometers"</span>, <span class="at">y =</span> <span class="st">"Kilometers"</span>, <span class="at">title =</span> <span class="st">"Comparison of kilometers and relative depreciation"</span>, <span class="at">subtitle =</span> <span class="st">"&lt;span style='color:royalblue;'&gt;&amp;#9899; Kilometers&lt;/span&gt;&lt;br/&gt;&lt;span style='color:orangered;'&gt;&amp;#9899; Relative depreciation&lt;/span&gt;"</span>) <span class="sc">+</span></span>
<span id="cb26-62"><a href="#cb26-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">/</span><span class="fu">max</span>(toyota<span class="sc">$</span>kilometers), <span class="at">name =</span> <span class="st">"Relative depreciation"</span>)) <span class="sc">+</span></span>
<span id="cb26-63"><a href="#cb26-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb26-64"><a href="#cb26-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_markdown</span>())</span>
<span id="cb26-65"><a href="#cb26-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-66"><a href="#cb26-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Patchwork</span></span>
<span id="cb26-67"><a href="#cb26-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-68"><a href="#cb26-68" aria-hidden="true" tabindex="-1"></a><span class="co">#(e2 | e3) /</span></span>
<span id="cb26-69"><a href="#cb26-69" aria-hidden="true" tabindex="-1"></a> <span class="co"># (e4 | e5) +</span></span>
<span id="cb26-70"><a href="#cb26-70" aria-hidden="true" tabindex="-1"></a>  <span class="co">#plot_annotation(</span></span>
<span id="cb26-71"><a href="#cb26-71" aria-hidden="true" tabindex="-1"></a>   <span class="co"># title = "Comparison of kilometers and relative depreciation"</span></span>
<span id="cb26-72"><a href="#cb26-72" aria-hidden="true" tabindex="-1"></a>  <span class="co">#)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true" href="">VW Golf</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false" href="">Audi A3</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false" href="">Skoda Octavia</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false" href="">Volvo XC60</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-5" role="tab" aria-controls="tabset-5-5" aria-selected="false" href="">Toyota Yaris</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>e1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_Q3_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>e2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_Q3_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>e3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_Q3_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>e4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_Q3_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-5-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-5-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>e5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_Q3_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Correlation matrices</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co"># golf</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>cor_matrix_golf <span class="ot">&lt;-</span> <span class="fu">cor</span>(<span class="fu">select</span>(golf, <span class="fu">c</span>(<span class="st">"depreciation"</span>, <span class="st">"rel_dep"</span>, <span class="st">"new.price"</span>, <span class="st">"price"</span>, <span class="st">"kilometers"</span>, <span class="st">"vehicle.age"</span>, <span class="st">"power"</span>, <span class="st">"consumption"</span>, <span class="st">"expertise"</span>, <span class="st">"warranty"</span>, <span class="st">"wagon"</span>, <span class="st">"diesel"</span>, <span class="st">"hybrid"</span>, <span class="st">"natural.gas"</span>, <span class="st">"manual"</span>, <span class="st">"awd"</span>)), <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="co"># We don't include natural gas vehicles because there are only 2 observations, and such a small sample size may lead to unreliable estimates of correlations.</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co"># When we run the correlation matrix with variable electric included, we get NAs for correlations between electric and every other variable. We explicitly remove all rows where there is a NA (use = "complete.obs"), so this may be the reason. Upon further inspection, we notice that consumption is NA for all electric vehicles.</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co"># We still want to check the correlations between electric and all other variables, so we will set consumption for electric vehicles to an arbitrary value, say -999, for our matrix to function correctly. We make a copy of the dataframe for this.</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co"># For the other vehicles, we will simply omit electric because the counts are too low.</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>golf2 <span class="ot">&lt;-</span> golf</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>golf2<span class="sc">$</span>consumption[golf2<span class="sc">$</span>electric <span class="sc">==</span> <span class="cn">TRUE</span>] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">999</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>cor_matrix_golf2 <span class="ot">&lt;-</span> <span class="fu">cor</span>(<span class="fu">select</span>(golf2, <span class="fu">c</span>(<span class="st">"depreciation"</span>, <span class="st">"rel_dep"</span>, <span class="st">"new.price"</span>, <span class="st">"price"</span>, <span class="st">"kilometers"</span>, <span class="st">"vehicle.age"</span>, <span class="st">"power"</span>, <span class="st">"consumption"</span>, <span class="st">"expertise"</span>, <span class="st">"warranty"</span>, <span class="st">"wagon"</span>, <span class="st">"diesel"</span>, <span class="st">"hybrid"</span>, <span class="st">"electric"</span>, <span class="st">"natural.gas"</span>, <span class="st">"manual"</span>, <span class="st">"awd"</span>)), <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="co"># audi</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>cor_matrix_audi <span class="ot">&lt;-</span> <span class="fu">cor</span>(<span class="fu">select</span>(audi, <span class="fu">c</span>(<span class="st">"depreciation"</span>, <span class="st">"rel_dep"</span>, <span class="st">"new.price"</span>, <span class="st">"price"</span>, <span class="st">"kilometers"</span>, <span class="st">"vehicle.age"</span>, <span class="st">"power"</span>, <span class="st">"consumption"</span>, <span class="st">"expertise"</span>, <span class="st">"warranty"</span>, <span class="st">"cabriolet"</span>, <span class="st">"diesel"</span>, <span class="st">"hybrid"</span>, <span class="st">"manual"</span>, <span class="st">"awd"</span>)), <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="co"># We omit natural gas vehicles (2 observations) and coupe (1 observation)</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a><span class="co"># skoda</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>cor_matrix_skoda <span class="ot">&lt;-</span> <span class="fu">cor</span>(<span class="fu">select</span>(skoda, <span class="fu">c</span>(<span class="st">"depreciation"</span>, <span class="st">"rel_dep"</span>, <span class="st">"new.price"</span>, <span class="st">"price"</span>, <span class="st">"kilometers"</span>, <span class="st">"vehicle.age"</span>, <span class="st">"power"</span>, <span class="st">"consumption"</span>, <span class="st">"expertise"</span>, <span class="st">"warranty"</span>, <span class="st">"sedan"</span>, <span class="st">"diesel"</span>, <span class="st">"hybrid"</span>, <span class="st">"natural.gas"</span>, <span class="st">"manual"</span>, <span class="st">"awd"</span>)), <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a><span class="co"># volvo</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>cor_matrix_volvo <span class="ot">&lt;-</span> <span class="fu">cor</span>(<span class="fu">select</span>(volvo, <span class="fu">c</span>(<span class="st">"depreciation"</span>, <span class="st">"rel_dep"</span>, <span class="st">"new.price"</span>, <span class="st">"price"</span>, <span class="st">"kilometers"</span>, <span class="st">"vehicle.age"</span>, <span class="st">"power"</span>, <span class="st">"consumption"</span>, <span class="st">"expertise"</span>, <span class="st">"warranty"</span>, <span class="st">"diesel"</span>, <span class="st">"hybrid"</span>, <span class="st">"manual"</span>)), <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a><span class="co"># toyota</span></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>cor_matrix_toyota <span class="ot">&lt;-</span> <span class="fu">cor</span>(<span class="fu">select</span>(toyota, <span class="fu">c</span>(<span class="st">"depreciation"</span>, <span class="st">"rel_dep"</span>, <span class="st">"new.price"</span>, <span class="st">"price"</span>, <span class="st">"kilometers"</span>, <span class="st">"vehicle.age"</span>, <span class="st">"power"</span>, <span class="st">"consumption"</span>, <span class="st">"expertise"</span>, <span class="st">"warranty"</span>, <span class="st">"sedan"</span>, <span class="st">"hybrid"</span>, <span class="st">"manual"</span>, <span class="st">"awd"</span>)), <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="correlation-matrices" class="level3">
<h3 class="anchored" data-anchor-id="correlation-matrices">2.3.7 Correlation matrices</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true" href="">VW Golf</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false" href="">Audi A3</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false" href="">Skoda Octavia</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-4" role="tab" aria-controls="tabset-6-4" aria-selected="false" href="">Volvo XC60</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-5" role="tab" aria-controls="tabset-6-5" aria-selected="false" href="">Toyota Yaris</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cor_matrix_golf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_Q3_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>cor_matrix_golf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>             depreciation     rel_dep   new.price       price  kilometers
depreciation   1.00000000  0.80840763  0.41254079 -0.35300383  0.68085722
rel_dep        0.80840763  1.00000000 -0.15911536 -0.79133539  0.88067928
new.price      0.41254079 -0.15911536  1.00000000  0.70666609 -0.22373055
price         -0.35300383 -0.79133539  0.70666609  1.00000000 -0.75863006
kilometers     0.68085722  0.88067928 -0.22373055 -0.75863006  1.00000000
vehicle.age    0.60444372  0.85637195 -0.28937055 -0.76669654  0.81678223
power          0.43521077 -0.06409617  0.87402014  0.55966440 -0.09116606
consumption    0.26799653  0.09701012  0.29203569  0.09178965  0.10031223
expertise     -0.18569255 -0.32854116  0.22339699  0.37368177 -0.27523648
warranty      -0.29835569 -0.40476392  0.11605425  0.35093852 -0.40824399
wagon          0.12127676  0.15642125 -0.03386621 -0.12898227  0.13927505
diesel         0.03755335  0.14566060 -0.14251048 -0.17554047  0.13425500
hybrid        -0.32363698 -0.36857564 -0.01241386  0.23862599 -0.34748629
natural.gas   -0.06092362 -0.06090522 -0.03151173  0.01495520 -0.03674571
manual        -0.02921012  0.26764708 -0.47293917 -0.46306573  0.28148941
awd            0.42583275  0.13609174  0.51377945  0.19694678  0.13712910
              vehicle.age       power  consumption    expertise    warranty
depreciation  0.604443722  0.43521077  0.267996534 -0.185692546 -0.29835569
rel_dep       0.856371952 -0.06409617  0.097010116 -0.328541163 -0.40476392
new.price    -0.289370550  0.87402014  0.292035686  0.223396986  0.11605425
price        -0.766696539  0.55966440  0.091789647  0.373681772  0.35093852
kilometers    0.816782231 -0.09116606  0.100312226 -0.275236479 -0.40824399
vehicle.age   1.000000000 -0.13883734  0.089320859 -0.313262286 -0.43714903
power        -0.138837339  1.00000000  0.408785170  0.125852566  0.03092017
consumption   0.089320859  0.40878517  1.000000000 -0.002995884 -0.09892328
expertise    -0.313262286  0.12585257 -0.002995884  1.000000000  0.04995323
warranty     -0.437149028  0.03092017 -0.098923280  0.049953230  1.00000000
wagon         0.125007373 -0.10047867  0.076218328 -0.074090868 -0.04398504
diesel        0.101182160 -0.25278556 -0.135238402  0.033647060 -0.04935853
hybrid       -0.349193659 -0.17468264 -0.631516480  0.242408924  0.15522013
natural.gas  -0.006374403 -0.04079170 -0.008263693 -0.060578836  0.01451486
manual        0.339585884 -0.36159389 -0.008817109 -0.125439128 -0.23234289
awd           0.129047345  0.46288379  0.412782962 -0.063949024 -0.04408324
                   wagon      diesel      hybrid  natural.gas       manual
depreciation  0.12127676  0.03755335 -0.32363698 -0.060923621 -0.029210123
rel_dep       0.15642125  0.14566060 -0.36857564 -0.060905215  0.267647082
new.price    -0.03386621 -0.14251048 -0.01241386 -0.031511729 -0.472939171
price        -0.12898227 -0.17554047  0.23862599  0.014955198 -0.463065732
kilometers    0.13927505  0.13425500 -0.34748629 -0.036745710  0.281489411
vehicle.age   0.12500737  0.10118216 -0.34919366 -0.006374403  0.339585884
power        -0.10047867 -0.25278556 -0.17468264 -0.040791695 -0.361593887
consumption   0.07621833 -0.13523840 -0.63151648 -0.008263693 -0.008817109
expertise    -0.07409087  0.03364706  0.24240892 -0.060578836 -0.125439128
warranty     -0.04398504 -0.04935853  0.15522013  0.014514864 -0.232342886
wagon         1.00000000  0.29925510 -0.16187511 -0.015593321 -0.021108057
diesel        0.29925510  1.00000000 -0.19069757 -0.013909603  0.098913862
hybrid       -0.16187511 -0.19069757  1.00000000 -0.020462355 -0.257156848
natural.gas  -0.01559332 -0.01390960 -0.02046236  1.000000000 -0.018757185
manual       -0.02110806  0.09891386 -0.25715685 -0.018757185  1.000000000
awd           0.23256920  0.12650902 -0.27283279 -0.022327148 -0.122993993
                     awd
depreciation  0.42583275
rel_dep       0.13609174
new.price     0.51377945
price         0.19694678
kilometers    0.13712910
vehicle.age   0.12904734
power         0.46288379
consumption   0.41278296
expertise    -0.06394902
warranty     -0.04408324
wagon         0.23256920
diesel        0.12650902
hybrid       -0.27283279
natural.gas  -0.02232715
manual       -0.12299399
awd           1.00000000</code></pre>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cor_matrix_audi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_Q3_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>cor_matrix_audi</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>             depreciation     rel_dep   new.price      price  kilometers
depreciation   1.00000000  0.84544058  0.39837613 -0.5277931  0.57372835
rel_dep        0.84544058  1.00000000 -0.11831445 -0.8676693  0.79445123
new.price      0.39837613 -0.11831445  1.00000000  0.5688035 -0.28157518
price         -0.52779308 -0.86766932  0.56880353  1.0000000 -0.77520880
kilometers     0.57372835  0.79445123 -0.28157518 -0.7752088  1.00000000
vehicle.age    0.55149521  0.80215172 -0.33240312 -0.8023404  0.68446569
power          0.19781328 -0.08973291  0.55038074  0.3322885 -0.23290319
consumption   -0.02280504 -0.12414754  0.19700952  0.2028855 -0.07457388
expertise     -0.13449413 -0.26705460  0.21408181  0.3188466 -0.23087338
warranty      -0.18419492 -0.35770733  0.26101947  0.4068789 -0.42840944
cabriolet      0.30904523  0.19740436  0.17839114 -0.1119259  0.03901160
diesel         0.19301142  0.26796448 -0.09028173 -0.2566768  0.27016561
hybrid        -0.21935012 -0.29297336  0.07819487  0.2691019 -0.33702995
manual        -0.16702206  0.13688424 -0.55765864 -0.3666385  0.22077812
awd            0.22468307  0.04079725  0.40802891  0.1763726  0.02486622
             vehicle.age       power consumption    expertise     warranty
depreciation  0.55149521  0.19781328 -0.02280504 -0.134494127 -0.184194916
rel_dep       0.80215172 -0.08973291 -0.12414754 -0.267054595 -0.357707328
new.price    -0.33240312  0.55038074  0.19700952  0.214081806  0.261019471
price        -0.80234040  0.33228849  0.20288553  0.318846584  0.406878872
kilometers    0.68446569 -0.23290319 -0.07457388 -0.230873384 -0.428409439
vehicle.age   1.00000000 -0.14811398 -0.14376952 -0.298528128 -0.495660082
power        -0.14811398  1.00000000 -0.05399960  0.037178133  0.087530848
consumption  -0.14376952 -0.05399960  1.00000000  0.290822891  0.057954464
expertise    -0.29852813  0.03717813  0.29082289  1.000000000  0.008170704
warranty     -0.49566008  0.08753085  0.05795446  0.008170704  1.000000000
cabriolet     0.22907039 -0.08412431 -0.02075843 -0.180382865  0.049439590
diesel        0.25692572 -0.14535369 -0.14311187 -0.036472308 -0.173935112
hybrid       -0.31598073  0.09363366 -0.47325674  0.102170850  0.122806067
manual        0.31667222 -0.45410549 -0.05258958 -0.069081835 -0.288267572
awd          -0.01534527  0.53489331  0.56521935  0.105817930  0.015403995
               cabriolet      diesel      hybrid      manual         awd
depreciation  0.30904523  0.19301142 -0.21935012 -0.16702206  0.22468307
rel_dep       0.19740436  0.26796448 -0.29297336  0.13688424  0.04079725
new.price     0.17839114 -0.09028173  0.07819487 -0.55765864  0.40802891
price        -0.11192586 -0.25667678  0.26910193 -0.36663853  0.17637263
kilometers    0.03901160  0.27016561 -0.33702995  0.22077812  0.02486622
vehicle.age   0.22907039  0.25692572 -0.31598073  0.31667222 -0.01534527
power        -0.08412431 -0.14535369  0.09363366 -0.45410549  0.53489331
consumption  -0.02075843 -0.14311187 -0.47325674 -0.05258958  0.56521935
expertise    -0.18038287 -0.03647231  0.10217085 -0.06908184  0.10581793
warranty      0.04943959 -0.17393511  0.12280607 -0.28826757  0.01540400
cabriolet     1.00000000 -0.02845915 -0.16430792  0.01842912 -0.09632621
diesel       -0.02845915  1.00000000 -0.24580696  0.15047594  0.16585892
hybrid       -0.16430792 -0.24580696  1.00000000 -0.24189797 -0.46181266
manual        0.01842912  0.15047594 -0.24189797  1.00000000 -0.23320072
awd          -0.09632621  0.16585892 -0.46181266 -0.23320072  1.00000000</code></pre>
</div>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cor_matrix_skoda)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_Q3_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>cor_matrix_skoda</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>             depreciation     rel_dep   new.price       price   kilometers
depreciation  1.000000000  0.87938889  0.14388619 -0.60019048  0.649305806
rel_dep       0.879388891  1.00000000 -0.31929432 -0.88814780  0.837747561
new.price     0.143886186 -0.31929432  1.00000000  0.70517486 -0.463605475
price        -0.600190483 -0.88814780  0.70517486  1.00000000 -0.839937847
kilometers    0.649305806  0.83774756 -0.46360547 -0.83993785  1.000000000
vehicle.age   0.666009140  0.85638240 -0.44953043 -0.84052920  0.742564330
power         0.051693649 -0.27004126  0.68727450  0.51846387 -0.324231639
consumption  -0.026525183 -0.10588345  0.15655765  0.14554550 -0.120187197
expertise    -0.242331163 -0.31318912  0.21778533  0.34965648 -0.220566612
warranty     -0.310430802 -0.31537425  0.02983437  0.24653443 -0.270572853
sedan         0.060214353  0.08358211 -0.05482650 -0.08745741  0.009441833
diesel        0.058196117  0.11080912 -0.11055071 -0.13105145  0.160160884
hybrid       -0.132817175 -0.19735554  0.14207254  0.20999470 -0.239681798
natural.gas   0.002629023  0.02294380 -0.04939150 -0.04180522 -0.024374348
manual        0.088747287  0.29190100 -0.38086932 -0.37143085  0.259723375
awd          -0.028711713 -0.10729647  0.16166898  0.15124345 -0.088991477
             vehicle.age        power consumption    expertise     warranty
depreciation  0.66600914  0.051693649 -0.02652518 -0.242331163 -0.310430802
rel_dep       0.85638240 -0.270041258 -0.10588345 -0.313189122 -0.315374252
new.price    -0.44953043  0.687274500  0.15655765  0.217785325  0.029834373
price        -0.84052920  0.518463874  0.14554550  0.349656477  0.246534430
kilometers    0.74256433 -0.324231639 -0.12018720 -0.220566612 -0.270572853
vehicle.age   1.00000000 -0.241293889 -0.02226864 -0.331129514 -0.315379242
power        -0.24129389  1.000000000  0.28320887  0.070445873 -0.003690788
consumption  -0.02226864  0.283208873  1.00000000 -0.096552279 -0.061779709
expertise    -0.33112951  0.070445873 -0.09655228  1.000000000  0.087015167
warranty     -0.31537924 -0.003690788 -0.06177971  0.087015167  1.000000000
sedan         0.14441735  0.016813385 -0.01012964 -0.098494727  0.044609974
diesel       -0.03290056 -0.502378108 -0.28883465  0.004579629  0.001538644
hybrid       -0.23117728  0.125625329 -0.63507162  0.190130782  0.098028616
natural.gas   0.02183926 -0.108080429  0.01994233 -0.091718490  0.023718936
manual        0.39440585 -0.204113703 -0.01588242 -0.083806155 -0.142163419
awd          -0.16909417 -0.139818491  0.18685173  0.087590305 -0.029151530
                    sedan       diesel      hybrid  natural.gas      manual
depreciation  0.060214353  0.058196117 -0.13281718  0.002629023  0.08874729
rel_dep       0.083582113  0.110809122 -0.19735554  0.022943803  0.29190100
new.price    -0.054826497 -0.110550709  0.14207254 -0.049391497 -0.38086932
price        -0.087457413 -0.131051452  0.20999470 -0.041805220 -0.37143085
kilometers    0.009441833  0.160160884 -0.23968180 -0.024374348  0.25972337
vehicle.age   0.144417348 -0.032900563 -0.23117728  0.021839255  0.39440585
power         0.016813385 -0.502378108  0.12562533 -0.108080429 -0.20411370
consumption  -0.010129636 -0.288834652 -0.63507162  0.019942331 -0.01588242
expertise    -0.098494727  0.004579629  0.19013078 -0.091718490 -0.08380616
warranty      0.044609974  0.001538644  0.09802862  0.023718936 -0.14216342
sedan         1.000000000 -0.061774967 -0.03279790 -0.007935758  0.09707000
diesel       -0.061774967  1.000000000 -0.28959572 -0.070070379 -0.06950538
hybrid       -0.032797905 -0.289595725  1.00000000 -0.017438508 -0.07679066
natural.gas  -0.007935758 -0.070070379 -0.01743851  1.000000000 -0.01858022
manual        0.097069996 -0.069505382 -0.07679066 -0.018580215  1.00000000
awd          -0.051333512  0.455738373 -0.26621584 -0.064413398 -0.14062067
                     awd
depreciation -0.02871171
rel_dep      -0.10729647
new.price     0.16166898
price         0.15124345
kilometers   -0.08899148
vehicle.age  -0.16909417
power        -0.13981849
consumption   0.18685173
expertise     0.08759030
warranty     -0.02915153
sedan        -0.05133351
diesel        0.45573837
hybrid       -0.26621584
natural.gas  -0.06441340
manual       -0.14062067
awd           1.00000000</code></pre>
</div>
</div>
</div>
<div id="tabset-6-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-4-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cor_matrix_volvo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_Q3_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>cor_matrix_volvo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>             depreciation    rel_dep   new.price      price  kilometers
depreciation   1.00000000  0.8728035  0.26240971 -0.5918680  0.60715660
rel_dep        0.87280347  1.0000000 -0.21903988 -0.8908621  0.81204771
new.price      0.26240971 -0.2190399  1.00000000  0.6224768 -0.38325327
price         -0.59186795 -0.8908621  0.62247680  1.0000000 -0.81257494
kilometers     0.60715660  0.8120477 -0.38325327 -0.8125749  1.00000000
vehicle.age    0.63954598  0.8591881 -0.39033394 -0.8447592  0.74209106
power          0.01298468 -0.3382465  0.71025546  0.5827500 -0.37376965
consumption    0.12810406  0.3499530 -0.49547495 -0.5177738  0.30784371
expertise     -0.26369346 -0.2306639 -0.05585917  0.1672118 -0.12913669
warranty      -0.12061764 -0.1762059  0.08324621  0.1673644 -0.21108400
diesel         0.28237544  0.5325968 -0.43973039 -0.5963335  0.57208398
hybrid        -0.40950792 -0.6441947  0.44130146  0.7007579 -0.56238683
manual         0.07406458  0.1565040 -0.11617893 -0.1571159  0.08077025
             vehicle.age        power  consumption    expertise    warranty
depreciation   0.6395460  0.012984682  0.128104059 -0.263693465 -0.12061764
rel_dep        0.8591881 -0.338246542  0.349953021 -0.230663856 -0.17620586
new.price     -0.3903339  0.710255463 -0.495474951 -0.055859172  0.08324621
price         -0.8447592  0.582749981 -0.517773842  0.167211828  0.16736436
kilometers     0.7420911 -0.373769650  0.307843707 -0.129136686 -0.21108400
vehicle.age    1.0000000 -0.362912068  0.388739680 -0.235672540 -0.21522747
power         -0.3629121  1.000000000 -0.637220072 -0.008971104  0.12252012
consumption    0.3887397 -0.637220072  1.000000000 -0.080028727 -0.08698791
expertise     -0.2356725 -0.008971104 -0.080028727  1.000000000  0.15794759
warranty      -0.2152275  0.122520116 -0.086987908  0.157947588  1.00000000
diesel         0.6076638 -0.540210875  0.202842321 -0.059291756 -0.22407461
hybrid        -0.7377671  0.496653243 -0.605712090  0.186571612  0.21549912
manual         0.2004431 -0.109681931  0.008983678  0.037828094 -0.02583568
                  diesel     hybrid       manual
depreciation  0.28237544 -0.4095079  0.074064584
rel_dep       0.53259683 -0.6441947  0.156504015
new.price    -0.43973039  0.4413015 -0.116178932
price        -0.59633346  0.7007579 -0.157115940
kilometers    0.57208398 -0.5623868  0.080770246
vehicle.age   0.60766382 -0.7377671  0.200443119
power        -0.54021088  0.4966532 -0.109681931
consumption   0.20284232 -0.6057121  0.008983678
expertise    -0.05929176  0.1865716  0.037828094
warranty     -0.22407461  0.2154991 -0.025835678
diesel        1.00000000 -0.6494793  0.159830888
hybrid       -0.64947928  1.0000000 -0.103806850
manual        0.15983089 -0.1038068  1.000000000</code></pre>
</div>
</div>
</div>
<div id="tabset-6-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-5-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cor_matrix_toyota)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_Q3_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>cor_matrix_toyota</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>             depreciation    rel_dep   new.price       price  kilometers
depreciation   1.00000000  0.9500502 -0.33100973 -0.73702107  0.71550906
rel_dep        0.95005022  1.0000000 -0.44175633 -0.79137122  0.81431412
new.price     -0.33100973 -0.4417563  1.00000000  0.88173034 -0.38125613
price         -0.73702107 -0.7913712  0.88173034  1.00000000 -0.63078247
kilometers     0.71550906  0.8143141 -0.38125613 -0.63078247  1.00000000
vehicle.age    0.80021681  0.8993308 -0.35384070 -0.65349476  0.81273237
power         -0.43327559 -0.5041148  0.88146761  0.84795836 -0.38891898
consumption   -0.08022548 -0.1004840  0.64733492  0.50375901 -0.06764937
expertise     -0.26479561 -0.2961187  0.12096085  0.21901878 -0.31350487
warranty      -0.06882982 -0.1175678  0.20032264  0.17789093 -0.24863769
sedan         -0.22672299 -0.2205110 -0.06725156  0.06517840 -0.23090816
hybrid        -0.09870985 -0.1604490 -0.09033986 -0.01535695 -0.12584694
manual         0.11776976  0.2052153  0.09797146  0.01129431  0.19566883
awd           -0.27261396 -0.3511149  0.85872731  0.75135009 -0.26528345
              vehicle.age      power  consumption    expertise    warranty
depreciation  0.800216811 -0.4332756 -0.080225480 -0.264795614 -0.06882982
rel_dep       0.899330813 -0.5041148 -0.100483975 -0.296118745 -0.11756783
new.price    -0.353840699  0.8814676  0.647334919  0.120960849  0.20032264
price        -0.653494761  0.8479584  0.503759008  0.219018779  0.17789093
kilometers    0.812732365 -0.3889190 -0.067649371 -0.313504870 -0.24863769
vehicle.age   1.000000000 -0.3895522  0.002752881 -0.214281263 -0.13049196
power        -0.389552210  1.0000000  0.790008590  0.139088808  0.20837214
consumption   0.002752881  0.7900086  1.000000000  0.135365848  0.06884672
expertise    -0.214281263  0.1390888  0.135365848  1.000000000  0.10759415
warranty     -0.130491956  0.2083721  0.068846719  0.107594145  1.00000000
sedan        -0.249999620 -0.1450061 -0.156741643  0.063840628 -0.10754036
hybrid       -0.175146183 -0.2708772 -0.670922983 -0.071659187 -0.04509024
manual        0.205280546  0.3187712  0.624112598  0.004099738  0.07626896
awd          -0.234650082  0.9706385  0.830238060  0.104984828  0.17089381
                   sedan      hybrid       manual        awd
depreciation -0.22672299 -0.09870985  0.117769759 -0.2726140
rel_dep      -0.22051095 -0.16044901  0.205215347 -0.3511149
new.price    -0.06725156 -0.09033986  0.097971464  0.8587273
price         0.06517840 -0.01535695  0.011294314  0.7513501
kilometers   -0.23090816 -0.12584694  0.195668826 -0.2652835
vehicle.age  -0.24999962 -0.17514618  0.205280546 -0.2346501
power        -0.14500609 -0.27087716  0.318771172  0.9706385
consumption  -0.15674164 -0.67092298  0.624112598  0.8302381
expertise     0.06384063 -0.07165919  0.004099738  0.1049848
warranty     -0.10754036 -0.04509024  0.076268965  0.1708938
sedan         1.00000000 -0.08267399 -0.039348850 -0.2080982
hybrid       -0.08267399  1.00000000 -0.799691298 -0.2767331
manual       -0.03934885 -0.79969130  1.000000000  0.3460499
awd          -0.20809816 -0.27673308  0.346049880  1.0000000</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>